/*
Copyright (c) 2013, Kinetic Data Inc. All rights reserved.
Version 5.1.3-dev
Date 2013-11-15 16:59:40
This file is a concatenation of the following files: kd_actions-min.js, kd_utils-min.js, kd_client-min.js
 */
if(typeof Dom=="undefined"){Dom=YAHOO.util.Dom;}if(typeof Connect=="undefined"){Connect=YAHOO.util.Connect;}if(typeof KD=="undefined"){KD={};}if(typeof KD.utils=="undefined"){KD.utils={};}if(!KD.utils.Action){KD.utils.Action=new function(){this.byPassValidation=false;this.readOnlyColor="#E0E0E0";this.highlightColor="#FF0000";this.sdrErrors=null;this.validateJsonLoaded=function(){if(typeof YAHOO.lang.JSON==="undefined"){var eMsg="The YUI JSON library is required for locking.  Please add it to your display page.";alert(eMsg);throw (eMsg);}};this.removeElement=function(label,keepValue){var label_id=label;var isOptional=false;if(label.constructor==Array){label_id=label[0];isOptional=label[1];}var qLayer=KD.utils.Util.getElementObject(label_id);if(qLayer){if(!keepValue){var theEls=KD.utils.Util.getElementsByClassName("answerValue","*",qLayer);for(var i=0;i<theEls.length;i++){KD.utils.Action.setQuestionValue(KD.utils.Util.getIDPart(theEls[i].id),"$NULL$");}}qLayer.style.display="none";if(isOptional){KD.utils.Action.makeQuestionOptional(label_id);}}};this.insertElement=function(label){var label_id=label;var isRequired=false;if(label.constructor==Array){label_id=label[0];isRequired=label[1];}var qLayer=KD.utils.Util.getElementObject(label_id);if(qLayer){var visib=Dom.getStyle(qLayer,"visibility");if(visib&&visib.toUpperCase()=="HIDDEN"){qLayer.style.visibility="visible";}qLayer.style.display="block";if(isRequired){KD.utils.Action.makeQuestionRequired(label_id);}}};this.hideElementInPlace=function(label,keepValue){var label_id=label;var isOptional=false;if(label.constructor==Array){label_id=label[0];isOptional=label[1];}var qLayer=KD.utils.Util.getElementObject(label_id);if(qLayer){if(!keepValue){var theEls=KD.utils.Util.getElementsByClassName("answerValue","*",qLayer);for(var i=0;i<theEls.length;i++){KD.utils.Action.setQuestionValue(KD.utils.Util.getIDPart(theEls[i].id),"$NULL$");}}qLayer.style.visibility="hidden";if(isOptional){KD.utils.Action.makeQuestionOptional(label_id);}}};this.showElementInPlace=function(label){var label_id=label;var isRequired=false;if(label.constructor==Array){label_id=label[0];isRequired=label[1];}var qLayer=KD.utils.Util.getElementObject(label_id);if(qLayer){qLayer.style.visibility="inherit";if(isRequired){KD.utils.Action.makeQuestionRequired(label_id);}}};this.addListener=function(object,triggerEvent,fnctn){YAHOO.util.Event.addListener(object,triggerEvent,fnctn);};this.highlightField=function(answerField){var type=KD.utils.Util.getAnswerType(answerField);var answerFieldDiv=answerField.parentNode;KD.utils.Util.addClass(answerFieldDiv,"requiredField");KD.utils.Util.addClass(answerFieldDiv,"requiredField_"+type);var labelObj=KD.utils.Util.getQuestionLabel(KD.utils.Util.getLabelFromAnswerEl(answerField));if(labelObj){KD.utils.Util.addClass(labelObj,"requiredLabel");KD.utils.Util.addClass(labelObj,"requiredLabel_"+type);var origColor=labelObj.getAttribute("origStyleColor");if(origColor==null||origColor==""){labelObj.setAttribute("origStyleColor",(labelObj.style.color)?labelObj.style.color:"defaultColor");labelObj.style.color=KD.utils.Action.highlightColor;}}};this.resetRequiredField=function(answerField){var type=KD.utils.Util.getAnswerType(answerField);var answerFieldDiv=answerField.parentNode;KD.utils.Util.removeClass(answerFieldDiv,"requiredField");KD.utils.Util.removeClass(answerFieldDiv,"requiredField_"+type);var labelObj=KD.utils.Util.getQuestionLabel(KD.utils.Util.getLabelFromAnswerEl(answerField));if(labelObj){KD.utils.Util.removeClass(labelObj,"requiredLabel");KD.utils.Util.removeClass(labelObj,"requiredLabel_"+type);var origStyle=labelObj.getAttribute("origStyleColor");if(origStyle=="defaultColor"){origStyle="";}labelObj.style.color=origStyle;labelObj.removeAttribute("origStyleColor");}};this.getErrorValue=function(answerField){var errorVal=answerField.getAttribute("errorValue");if(errorVal==null||errorVal==""){var labelObj=KD.utils.Util.getQuestionLabel(KD.utils.Util.getLabelFromAnswerEl(answerField));if(labelObj!=null){errorVal=KD.utils.Util.getQuestionLabelValue(labelObj);if(errorVal==null||errorVal==""){errorVal=labelObj.getAttribute("label");}}}return errorVal;};this.mimicRadioClick=function(elementId,elIndex){var myRadioElements=document.getElementsByName(elementId);myRadioElements[elIndex].click();};this.watchFieldLength=function(el){var limit=el.getAttribute("maxlength");if(limit){limit=parseInt(limit);}else{return;}if(el.value&&el.value.length>limit){el.value=el.value.substring(0,limit);}};this.loadPreviousPage=function(){var valid=true;if(KD.utils.ClientManager.isAuthenticationRequired==="true"){KD.utils.Action.byPassValidation=true;KD.utils.ClientManager.checkSession();var response=KD.utils.ClientManager.sessionCheck;if(response.status!==200){var message=response.statusText;if(response.getResponseHeader!=null&&response.getResponseHeader["X-Error-Message"]!=null){message=response.getResponseHeader["X-Error-Message"];}KD.utils.ClientManager.registerInvalidSessionRequest("PREV_PAGE_REQUEST","","","");KD.utils.Action.handleHttpErrorCode(response.status,message);valid=false;}}if(!valid){for(var i=0;i<KD.utils.ClientManager.submitButtons.length;i++){KD.utils.Action.enableButton(KD.utils.ClientManager.submitButtons[i]);}KD.utils.ClientManager.isSubmitting=false;return;}document.pageQuestionsForm.action="PreviousPage";this.byPassValidation=true;document.pageQuestionsForm.submit();};this.validateForm=function(evt,form){var trigger=YAHOO.util.Event.getTarget(evt);var pageId=Dom.get("pageID").value;var valid=true;var clientAction,fn;if(!trigger.type||(trigger.type&&trigger.type.toUpperCase()!="BUTTON"&&trigger.type.toUpperCase()!="SUBMIT")){try{YAHOO.util.Event.stopEvent(evt);}catch(e){}KD.utils.ClientManager.isSubmitting=false;return false;}if(KD.utils.Action.byPassValidation){return true;}var actions=KD.utils.ClientManager.customEvents.getItem(pageId+"-beforeSubmit");if(actions&&actions.length>0){for(var k=0;k<actions.length;k++){clientAction=actions[k];fn=clientAction.action;
valid=fn.call(evt,evt,clientAction);if(valid==null){valid=true;}if(valid==false){try{YAHOO.util.Event.stopEvent(evt);}catch(e){}for(var i=0;i<KD.utils.ClientManager.submitButtons.length;i++){KD.utils.Action.enableButton(KD.utils.ClientManager.submitButtons[i]);}KD.utils.ClientManager.isSubmitting=false;return false;}}}valid=KD.utils.Action.validateFields(form.elements);if(valid){var submitActions=KD.utils.ClientManager.customEvents.getItem(pageId+"-submit");if(submitActions&&submitActions.length>0){for(var m=0;m<submitActions.length;m++){clientAction=submitActions[m];fn=clientAction.action;valid=fn.call(evt,evt,clientAction);if(valid==null){valid=true;}if(valid==false){break;}}}}if(valid){if(KD.utils.ClientManager.isAuthenticationRequired==="true"){KD.utils.ClientManager.checkSession();var response=KD.utils.ClientManager.sessionCheck;if(response.status!==200){var message=response.statusText;if(response.getResponseHeader!=null&&response.getResponseHeader["X-Error-Message"]!=null){message=response.getResponseHeader["X-Error-Message"];}KD.utils.ClientManager.registerInvalidSessionRequest("NEXT_PAGE_REQUEST","","","");KD.utils.Action.handleHttpErrorCode(response.status,message);valid=false;}}}if(!valid){try{YAHOO.util.Event.stopEvent(evt);}catch(e){}for(i=0;i<KD.utils.ClientManager.submitButtons.length;i++){KD.utils.Action.enableButton(KD.utils.ClientManager.submitButtons[i]);}KD.utils.ClientManager.isSubmitting=false;}if(valid&&trigger.type&&trigger.type.toUpperCase()=="BUTTON"){KD.utils.Action._clearTransientFields(form);form.submit();}return valid;};this.validateFields=function(fieldsArray){var valid=true;var nextElement=null;var firstErrorElement=null;var requiredFieldList="";var formatFieldList="";var requiredWarning=KD.utils.ClientManager.requiredWarningStr;var formatWarning=KD.utils.ClientManager.validFormatWarningStr;var maxCharsOnSubmit=KD.utils.ClientManager.maxCharsOnSubmit;var characterCount=0;var disabledFields=new Array();var checkedFields=new Array();var checkboxFields={};var fieldPrefix="<li>";var fieldSuffix="</li>";for(var f=0;f<fieldsArray.length;f++){var cb=fieldsArray[f].type&&fieldsArray[f].type.toLowerCase()=="checkbox";if(cb){var cbChecked=fieldsArray[f].checked;var reqAttr=fieldsArray[f].getAttribute("required");if(reqAttr&&reqAttr.toLowerCase()=="true"){var cbParentId=KD.utils.Util.getCheckboxParentId(fieldsArray[f]);if(cbParentId){var cbParentExists=typeof checkboxFields[cbParentId]!=="undefined";if(!cbParentExists||(cbParentExists&&checkboxFields[cbParentId]==false)){checkboxFields[cbParentId]=fieldsArray[f].checked;}}}}}for(var i=0;i<fieldsArray.length;i++){nextElement=fieldsArray[i];if(nextElement.disabled==true&&nextElement.type&&nextElement.type.toUpperCase()!="SUBMIT"&&nextElement.type.toUpperCase()!="BUTTON"){disabledFields.push(nextElement);}if(KD.utils.Action._isTransient(nextElement)){continue;}var foundValue=false;if(nextElement.type=="radio"||nextElement.type=="checkbox"){if(nextElement.checked){characterCount+=nextElement.value.length;foundValue=true;}}else{if(nextElement.type!="button"&&nextElement.value.length>0){characterCount+=nextElement.value.length;foundValue=true;}}if(foundValue){characterCount+=nextElement.name.length+1;}if(nextElement.getAttribute("required")=="true"&&checkedFields[nextElement.name]!="true"){checkedFields[nextElement.name]="true";if(nextElement.tagName.toLowerCase()=="select"){if(nextElement.options.length==0||nextElement.selectedIndex==null||nextElement.value==""){requiredFieldList+=fieldPrefix+KD.utils.Action.getErrorValue(nextElement)+fieldSuffix;if(firstErrorElement==null){firstErrorElement=nextElement;}KD.utils.Action.highlightField(nextElement);valid=false;}else{KD.utils.Action.resetRequiredField(nextElement);}}else{if(nextElement.type.toLowerCase()=="radio"){var radioGroup=document.getElementsByName(nextElement.name);var isChecked=false;for(var j=0;j<radioGroup.length;j++){if(radioGroup[j].checked==true){isChecked=true;}}if(isChecked==false){if(firstErrorElement==null){firstErrorElement=radioGroup[0];}KD.utils.Action.highlightField(radioGroup[0]);requiredFieldList+=fieldPrefix+KD.utils.Action.getErrorValue(radioGroup[0])+fieldSuffix;valid=false;}else{KD.utils.Action.resetRequiredField(radioGroup[0]);}}else{if(nextElement.type.toLowerCase()=="checkbox"){cbParentId=KD.utils.Util.getCheckboxParentId(nextElement);if(cbParentId&&typeof checkedFields[cbParentId]=="undefined"){if(checkboxFields[cbParentId]!=true){if(firstErrorElement==null){firstErrorElement=nextElement;}KD.utils.Action.highlightField(nextElement);requiredFieldList+=fieldPrefix+KD.utils.Action.getErrorValue(nextElement)+fieldSuffix;valid=false;}checkedFields[cbParentId]="true";}if(cbParentId&&checkboxFields[cbParentId]==true){KD.utils.Action.resetRequiredField(nextElement);}}else{if((!nextElement.value||nextElement.value.length<1)&&nextElement.type.toLowerCase()!="checkbox"){if(firstErrorElement==null){firstErrorElement=nextElement;}var isDate=false;var myParent=nextElement.parentNode;for(var iIdx=0;iIdx<myParent.children.length;iIdx++){if(myParent.children[iIdx].id!=undefined&&myParent.children[iIdx].id.indexOf("year_")!=-1){KD.utils.Action.highlightField(myParent.children[iIdx]);isDate=true;break;}}if(!isDate){KD.utils.Action.highlightField(nextElement);}requiredFieldList+=fieldPrefix+KD.utils.Action.getErrorValue(nextElement)+fieldSuffix;valid=false;continue;}else{KD.utils.Action.resetRequiredField(nextElement);}}}}}if(nextElement.value.length>0&&nextElement.getAttribute("validationFormat")){var expStr=nextElement.getAttribute("validationFormat");var exp=new RegExp(expStr);if(exp.test(nextElement.value)==false){KD.utils.Action.highlightField(nextElement);var validationText=nextElement.getAttribute("validationText");if(validationText){formatFieldList+=fieldPrefix+validationText+fieldSuffix;}valid=false;}else{KD.utils.Action.resetRequiredField(nextElement);}}else{if((nextElement.value.length==0&&nextElement.getAttribute("required")!="true")&&nextElement.getAttribute("validationFormat")){KD.utils.Action.resetRequiredField(nextElement);
}}if(nextElement.name&&nextElement.name.indexOf("SRVQSTN_")!=-1){var isDateField=KD.utils.Util.isDate(nextElement);if(isDateField){var validDate=KD.utils.Action.validateDateField(nextElement);if(!validDate){if(firstErrorElement==null){firstErrorElement=nextElement;}KD.utils.Action.highlightField(nextElement);var label="";var labelObj=KD.utils.Util.getQuestionLabel(KD.utils.Util.getLabelFromAnswerEl(nextElement));if(labelObj&&labelObj.getAttribute("label")){label=labelObj.getAttribute("label");}formatFieldList+=fieldPrefix+label+" is not a valid date"+fieldSuffix;valid=false;}else{KD.utils.Action.resetRequiredField(nextElement);}}}}if(!valid){var errorStr="";if(requiredFieldList){errorStr+="<div class='warningTitle'><h3>"+requiredWarning+"</h3><ul>"+requiredFieldList+"</ul></div>";}if(formatFieldList){errorStr+="<div class='warningTitle'><h3>"+formatWarning+"</h3><ul>"+formatFieldList+"</ul></div>";}KD.utils.ClientManager.alertPanel({header:"Form Validation Errors",body:errorStr,element:firstErrorElement});return false;}if(characterCount>maxCharsOnSubmit){KD.utils.ClientManager.alertPanel({header:"Form Error",body:KD.utils.ClientManager.tooManyCharactersForSubmitStr,element:null});return false;}for(j=0;j<disabledFields.length;j++){if(disabledFields[j].id.indexOf("SRVQSTN_")!=-1){disabledFields[j].disabled=false;}}return true;};this.validateDateField=function(el){var elValue,dtParts,yr,mn,dy,d1,h,m,s;if(el&&el.value&&el.value!=null&&el.value!=""){elValue=el.value;dtParts=KD.utils.Util.parseDtString(elValue);yr=dtParts[0];mn=dtParts[1]-1;dy=dtParts[2];if(dtParts.length>3){h=dtParts[3];m=dtParts[4];s=dtParts[5];d1=new Date(yr,mn,dy,h,m,s,0);if(d1.getFullYear()!=yr||d1.getMonth()!=mn||d1.getDate()!=dy||d1.getHours()!=h||d1.getMinutes()!=m||d1.getSeconds()!=s){return false;}}else{d1=new Date(yr,mn,dy);if(d1.getFullYear()!=yr||d1.getMonth()!=mn||d1.getDate()!=dy){return false;}}}return true;};this._clearTransientFields=function(form){var i,els;form=Dom.get(form);els=form.elements;for(i=0;i<els.length;i+=1){if(KD.utils.Action._isTransient(els[i])){els[i].value="";}}};this._isTransient=function(el){var attValue,attName="transient",testValue="transient";attValue=el.getAttribute(attName);return(attValue&&attValue.toLowerCase()===testValue);};this.setQuestionValue=function(label_id,value){return KD.utils.Util.setQuestionValue(label_id,value);};this.getQuestionValue=function(label_id){return KD.utils.Util.getQuestionValue(label_id);};this.setReadOnly=function(label_id){var elements=new Array();var element=KD.utils.Util.getElementObject(label_id);if(KD.utils.Util.hasClass(element,"templateSection")){element=KD.utils.Util.getElementObject(label_id,"SECTION_");if(element){elements=element.children;for(var i=0;i<elements.length;i++){this.setReadOnly(KD.utils.Util.getIDPart(elements[i].id));}return;}}else{if(KD.utils.Util.hasClass(element,"questionLayer")){element=KD.utils.Util.getElementObject(label_id,"QANSWER_");if(element){elements=element.children;var els=new Array();for(i=0;i<elements.length;i++){if(KD.utils.Util.hasClass(elements[i],"answerCheckbox")){els[i]=elements[i].children[0];}else{els[i]=elements[i];}}}}}if(els){if(!KD.utils.Util.isArray(els)){els=[els];}for(i=0;i<els.length;i++){var qst=els[i];if(qst.tagName&&(qst.tagName.toUpperCase()=="INPUT"||qst.tagName.toUpperCase()=="TEXTAREA")){if(qst.type&&(qst.type.toUpperCase()=="RADIO"||qst.type.toUpperCase()=="CHECKBOX")||qst.type.toUpperCase()=="SUBMIT"||qst.type.toUpperCase()=="BUTTON"){qst.disabled=true;}else{qst.setAttribute("readOnly","readOnly");qst.style.backgroundColor=KD.utils.Action.readOnlyColor;if(KD.utils.Util.hasClass(qst,"dateYear")||KD.utils.Util.hasClass(qst,"dtYear")){var calParent=qst.parentNode;var calPicker=calParent.getElementsByTagName("img")[0];if(calPicker&&calPicker.tagName&&calPicker.tagName.toUpperCase()=="IMG"){calPicker.style.display="none";}}}}else{if(qst.tagName&&qst.tagName.toUpperCase()=="SELECT"){qst.disabled=true;}}}}else{if((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_"))||(KD.utils.Util.getElementObject(label_id,"DYNAMIC_TEXT_"))||(KD.utils.Util.getElementObject(label_id,"IMAGE_"))){var nodeRef=((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_"))||(KD.utils.Util.getElementObject(label_id,"DYNAMIC_TEXT_"))||(KD.utils.Util.getElementObject(label_id,"IMAGE_")));KD.utils.Action._iterActionCall.call(this,nodeRef,KD.utils.Action.setReadOnly);}else{alert("function setReadOnly - Unable to locate the Object for: "+label_id);}}};this.setReadWrite=function(label_id){var elements=new Array();var element=KD.utils.Util.getElementObject(label_id);if(KD.utils.Util.hasClass(element,"templateSection")){element=KD.utils.Util.getElementObject(label_id,"SECTION_");if(element){elements=element.children;for(var i=0;i<elements.length;i++){this.setReadWrite(KD.utils.Util.getIDPart(elements[i].id));}return;}}else{if(KD.utils.Util.hasClass(element,"questionLayer")){element=KD.utils.Util.getElementObject(label_id,"QANSWER_");if(element){elements=element.children;var els=new Array();for(i=0;i<elements.length;i++){if(KD.utils.Util.hasClass(elements[i],"answerCheckbox")){els[i]=elements[i].children[0];}else{els[i]=elements[i];}}}}}if(els){if(!KD.utils.Util.isArray(els)){els=[els];}for(i=0;i<els.length;i++){var qst=els[i];if(qst.tagName&&(qst.tagName.toUpperCase()=="INPUT"||qst.tagName.toUpperCase()=="TEXTAREA")&&!qst.getAttribute("fileTypesAllowed")){if(qst.type&&(qst.type.toUpperCase()=="RADIO"||qst.type.toUpperCase()=="CHECKBOX"||qst.type.toUpperCase()=="SUBMIT"||qst.type.toUpperCase()=="BUTTON")){qst.disabled=false;}else{qst.removeAttribute("readOnly");qst.style.backgroundColor="";if(KD.utils.Util.hasClass(qst,"dateYear")||KD.utils.Util.hasClass(qst,"dtYear")){var calParent=qst.parentNode;var calPicker=calParent.getElementsByTagName("img")[0];if(calPicker&&calPicker.tagName&&calPicker.tagName.toUpperCase()=="IMG"){calPicker.style.display="";
}}if(KD.utils.Util.hasClass(qst,"dateHidden")||KD.utils.Util.hasClass(qst,"dateLocal")||KD.utils.Util.hasClass(qst,"dtHidden")||KD.utils.Util.hasClass(qst,"dtLocal")){qst.setAttribute("readOnly","readOnly");qst.style.backgroundColor=KD.utils.Action.readOnlyColor;}}}else{if(qst.tagName&&qst.tagName.toUpperCase()=="SELECT"){qst.disabled=false;}}}}else{if((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_"))||(KD.utils.Util.getElementObject(label_id,"DYNAMIC_TEXT_"))||(KD.utils.Util.getElementObject(label_id,"IMAGE_"))){var nodeRef=((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_"))||(KD.utils.Util.getElementObject(label_id,"DYNAMIC_TEXT_"))||(KD.utils.Util.getElementObject(label_id,"IMAGE_")));KD.utils.Action._iterActionCall.call(this,nodeRef,KD.utils.Action.setReadWrite);}else{alert("function setReadWrite - Unable to locate the Object for: "+label_id);}}};this.disableButton=function(label_id){var div=KD.utils.Util.getButtonObject(label_id);if(div&&div!=""){var input=div.getElementsByTagName("input");input[0].disabled=true;}else{alert("function disableButton - Unable to locate the Object for: "+label_id);}};this.enableButton=function(label_id){var div=KD.utils.Util.getButtonObject(label_id);if(div&&div!=""){var input=div.getElementsByTagName("input");input[0].disabled=false;}else{alert("function enableButton - Unable to locate the Object for: "+label_id);}};this.disableSubmitButtons=function(e){for(var i=0;i<KD.utils.ClientManager.submitButtons.length;i+=1){KD.utils.Action.disableButton(KD.utils.ClientManager.submitButtons[i]);}};this.enableSubmitButtons=function(e){for(var i=0;i<KD.utils.ClientManager.submitButtons.length;i+=1){KD.utils.Action.enableButton(KD.utils.ClientManager.submitButtons[i]);}};this.checkPattern=function(obj){var qstn=KD.utils.Util.getElementFromObject(obj);var valFormat=qstn.getAttribute("validationFormat");if(valFormat&&valFormat!=""){var expStr=qstn.getAttribute("validationFormat");var exp=new RegExp(expStr);var qstnVal=KD.utils.Util.trimString(qstn.value);if(qstnVal!=null&&qstnVal.length>0&&exp.test(qstnVal)==false){KD.utils.Action.highlightField(qstn);var validationText=qstn.getAttribute("validationText");KD.utils.ClientManager.alertPanel({header:"Invalid Formatted Field",body:validationText,element:null});KD.utils.Action._enableButtonEvents();return;}if((qstnVal==null||qstnVal=="")||exp.test(qstnVal)==true){KD.utils.Action.resetRequiredField(qstn);KD.utils.Action._enableButtonEvents();var patternError=qstn.getAttribute("patternError");if(patternError){qstn.removeAttribute("patternError");}}}};this.makeQuestionRequired=function(label_id){var els=KD.utils.Util.getQuestionInput(label_id);if(els){if(!KD.utils.Util.isArray(els)){els=[els];}for(var i=0;i<els.length;i++){var cls=els[i].className;if(cls!=null&&(cls.indexOf("dateYear")!=-1||cls.indexOf("dateMonth")!=-1||cls.indexOf("dateDay")!=-1)||cls.indexOf("dateLocal")!=-1){continue;}if(cls!=null&&(cls.indexOf("dtYear")!=-1||cls.indexOf("dtMonth")!=-1||cls.indexOf("dtDay")!=-1||cls.indexOf("dtHour")!=-1||cls.indexOf("dtMin")!=-1||cls.indexOf("dtAMPM")!=-1||cls.indexOf("dtLocal")!=-1)){continue;}els[i].setAttribute("required","true");var errorValue=els[i].getAttribute("errorValue");if(!errorValue||errorValue==""){els[i].setAttribute("errorValue",KD.utils.Util.getLabelValueFromAnswerEl(els[i]));}}KD.utils.ClientManager.setPreRequire(label_id);}else{if((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_"))){var nodeRef=((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_")));KD.utils.Action._iterActionCall.call(this,nodeRef,KD.utils.Action.makeQuestionRequired);}}};this.makeQuestionOptional=function(label_id){var els=KD.utils.Util.getQuestionInput(label_id);if(els){if(!KD.utils.Util.isArray(els)){els=[els];}for(var i=0;i<els.length;i++){els[i].removeAttribute("required");}KD.utils.Action.resetRequiredField(els[0]);KD.utils.ClientManager.clearPreRequire(label_id);}else{if((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_"))){var nodeRef=((KD.utils.Util.getElementObject(label_id,"PAGE_"))||(KD.utils.Util.getElementObject(label_id,"SECTION_")));KD.utils.Action._iterActionCall.call(this,nodeRef,KD.utils.Action.makeQuestionOptional);}}};this.applyValueActions=function(el,clientAction){if(!clientAction||!clientAction.action||!el||!el.type){return;}var fire=false;if(el.type.toUpperCase()=="RADIO"&&el.checked){fire=true;}else{if(el.type.toUpperCase()=="CHECKBOX"&&el.checked){fire=true;}else{if((el.type.toUpperCase()=="TEXT"||el.tagName.toUpperCase()=="SELECT"||el.tagName.toUpperCase()=="TEXTAREA")&&el.value&&el.value!=""){fire=true;}}}if(fire){clientAction.action.apply(KD.utils.Action,[{target:el,type:clientAction.jsEvent},clientAction]);}};this.showResultsAsAdvancedTable=function(recordXMLArray,questions,source){var cols=[],visibleCols=[];for(var question in questions[0]){questions[0][question]["qId"]=question;cols.push(questions[0][question]);}cols.sort(function(a,b){return a["sort_order"]-b["sort_order"];});for(var col in cols){if(cols[col]["visible"]=="Yes"||cols[col]["visible"]==null||cols[col]["visible"]==""){visibleCols.push(cols[col]);}}var theTable=document.createElement("table");var theHead=document.createElement("thead");var theBody=document.createElement("tbody");var oddEven="odd";if(recordXMLArray&&recordXMLArray.length>0){var headerRow=document.createElement("tr");var headerFields=recordXMLArray[0].getElementsByTagName("field");for(var col in visibleCols){var qId=visibleCols[col]["qId"];var thisCell=document.createElement("th");var colLabel=KD.utils.Action._getAdvancedColumnLabel(visibleCols[col],source);thisCell.appendChild(document.createTextNode(colLabel));headerRow.appendChild(thisCell);}headerRow.id="headerRow";theHead.appendChild(headerRow);for(var i=0;
i<recordXMLArray.length;i++){var thisRow=document.createElement("tr");thisRow.id="row_"+i;thisRow.className="record row_"+oddEven;var fields=recordXMLArray[i].getElementsByTagName("field");var values={};if(source=="bridge"){for(var fieldIndex=0;fieldIndex<fields.length;fieldIndex++){if(fields[fieldIndex].textContent){value=fields[fieldIndex].textContent;}else{value=fields[fieldIndex].text;}values[fields[fieldIndex].getAttribute("id")]=value||"";}}for(col in visibleCols){var qId=visibleCols[col]["qId"];var map=visibleCols[col][qId];var value;if(source=="bridge"){value=map;var attributePattern=/<%=\s*attribute\["(.+?)"\]\s*%>/;var match=attributePattern.exec(value);while(match!=null){value=value.replace(match[0],values[match[1]]);match=attributePattern.exec(value);}}else{value=KD.utils.Action._getAdvancedColumnValue(map,fields);}var thisCell=document.createElement("td");thisCell.appendChild(document.createTextNode(value));thisCell.id="r_"+i+"_c_"+col;thisRow.appendChild(thisCell);}theBody.appendChild(thisRow);if(oddEven=="odd"){oddEven="even";}else{oddEven="odd";}}}theTable.appendChild(theHead);theTable.appendChild(theBody);return theTable;};this._getAdvancedColumnLabel=function(col,source){var label=col["table_label"];if(label==null||KD.utils.Util.trimString(label)==""){var questionId=col["qId"];var fieldMap=col[questionId];if(source=="bridge"){var attributePattern=/<%=\s*attribute\["(.+?)"\]\s*%>/;var match=attributePattern.exec(fieldMap);if(match){label=match[1];}}else{var flds=fieldMap.split("</FLD>");for(var i=0;i<flds.length;i++){if(flds[i].indexOf("<FLD>")>-1){label=(flds[i].split(";")[0]).substring(flds[i].indexOf("<FLD>")+5);break;}}}}return label;};this._getAdvancedColumnValue=function(fieldMap,fields){var fieldName="",value="",fieldValue="",flds=fieldMap.split("</FLD>");for(var i=0;i<flds.length;i++){if(flds[i].indexOf("<FLD>")==-1){value+=flds[i];}else{var segs=flds[i].split("<FLD>");if(segs.length>1){value+=segs[0];}fieldName=(flds[i].split(";")[0]).substring(flds[i].indexOf("<FLD>")+5);for(var j=0;j<fields.length;j++){if(fields[j].getAttribute("id")==fieldName){if(fields[j].childNodes.length>0){fieldValue=fields[j].firstChild.nodeValue;}else{fieldValue="";}}}value+=fieldValue;}}value=value.replace(/%0A/gi,"\n");value=value.replace(/%0D/gi,"\n");return KD.utils.Util.trimString(value);};this.showResultsAsTable=function(recordXMLArray,tableId,tableClass){var theTable=document.createElement("table");var thisCell;if(tableId){theTable.setAttribute("id",tableId);}if(tableClass){theTable.className=tableClass;}var theBody=document.createElement("tbody");var oddEven="odd";if(recordXMLArray&&recordXMLArray.length>0){var headerRow=document.createElement("tr");var headerFields=recordXMLArray[0].getElementsByTagName("field");for(var a=0;a<headerFields.length;a++){thisCell=document.createElement("th");thisCell.appendChild(document.createTextNode(headerFields[a].getAttribute("id")));headerRow.appendChild(thisCell);}headerRow.id="headerRow";theBody.appendChild(headerRow);for(var i=0;i<recordXMLArray.length;i++){var thisRow=document.createElement("tr");thisRow.id="row_"+i;thisRow.className="record row_"+oddEven;var fields=recordXMLArray[i].getElementsByTagName("field");for(var k=0;k<fields.length;k++){thisCell=document.createElement("td");var fieldValue="";if(fields[k].firstChild){fieldValue=fields[k].firstChild.nodeValue;}thisCell.appendChild(document.createTextNode(fieldValue));thisCell.id="r_"+i+"_c_"+k;thisRow.appendChild(thisCell);}theBody.appendChild(thisRow);if(oddEven=="odd"){oddEven="even";}else{oddEven="odd";}}}theTable.appendChild(theBody);return theTable;};this.displayError=function(message,response){KD.utils.ClientManager.alertPanel({header:"Error",body:"<b>The following error occurred:</b> "+message,element:null});};this.makeAsyncBridgeRequest=function(source,sourceId,parameterString,callback){source=encodeURIComponent(source);sourceId=encodeURIComponent(sourceId);var now=new Date();var path="BridgeDataRequest"+"?formId="+KD.utils.ClientManager.templateId+"&source="+source+"&bridgedResourceId="+sourceId+parameterString+"&noCache="+now.getTime();var failureCallback=callback.failure;var failureCallbackWrapper=function(response){if(response.status==401){KD.utils.ClientManager.registerUnauthorizedSessionRequest(sourceId,"GET",path,{success:callback.success,failure:failureCallbackWrapper,argument:callback.argument});if(document.getElementById("simpleLogin")==null){KD.utils.Action.handleHttpErrorCode(response.status,"Not authorized.");}}else{failureCallback(response);}};callback["failure"]=failureCallbackWrapper;Connect.asyncRequest("GET",path,callback);};this.makeAsyncRequest=function(requestName,dataRequestId,callback,paramString,format,useGetList,synchronous){if(KD.utils.Action.sdrErrors==null){KD.utils.Action.sdrErrors=new KD.utils.Hash();}if(paramString&&paramString!=""&&paramString.indexOf("&")!=0){paramString="&"+paramString;}dataRequestId=encodeURIComponent(dataRequestId);requestName=encodeURIComponent(requestName);var sessionId=encodeURIComponent(KD.utils.ClientManager.sessionId);var now=new Date();var entryParam="";if(useGetList==true){entryParam="&useGetList=true";}var path="SimpleDataRequest?requestName="+requestName+"&dataRequestId="+dataRequestId+"&sessionId="+sessionId+"&format="+format+paramString+entryParam+"&noCache="+now.getTime();KD.utils.ClientManager.registerInvalidSessionRequest(dataRequestId,"GET",path,callback);if(callback.includeLoadingImage){var elId=null,el=null;if(KD.utils.Util.isArray(callback.argument[0])){elId=callback.argument[0][0];}else{elId=callback.argument[0];}if(elId){el=Dom.get(elId);}if(el){el.innerHTML='<img src="./resources/catalogIcons/ajax-loader.gif" class="ajax_load_img">';}}var isActive=KD.utils.ClientManager.isActiveConnection(dataRequestId);var isValid=true;if(isActive){var prevCall=KD.utils.ClientManager.getConnection(dataRequestId);if(prevCall[1]==paramString){isValid=false;}else{try{prevCall[0].conn.abort(prevCall,callback,false);}catch(error){}}}if(isValid){var fnctnError=callback.error;
callback.failure=function(response){var message=response.statusText;if(response.getResponseHeader!=null&&response.getResponseHeader["X-Error-Message"]!=null){message=response.getResponseHeader["X-Error-Message"];}var connectionStatus=response.getResponseHeader["Connection"];if(!KD.utils.Action.sdrErrors.getItem(response.status)||!connectionStatus||connectionStatus.indexOf("close")!=-1){KD.utils.Action.sdrErrors.setItem(response.status,message);if(!connectionStatus||connectionStatus.indexOf("close")!=-1){KD.utils.ClientManager.checkSession();var sessionResponse=KD.utils.ClientManager.sessionCheck;if(sessionResponse.status!==200){if(callback.includeLoadingImage&&el){el.innerHTML="";}var sessionMessage=sessionResponse.statusText;if(sessionResponse.getResponseHeader!=null&&sessionResponse.getResponseHeader["X-Error-Message"]!=null){sessionMessage=sessionResponse.getResponseHeader["X-Error-Message"];}KD.utils.Action.handleHttpErrorCode(sessionResponse.status,sessionMessage);}}else{KD.utils.Action.handleHttpErrorCode(response.status,sessionMessage);}return;}if(fnctnError){fnctnError(response);}};var fnctnSuccess=callback.success;callback.success=function(response){KD.utils.Action.sdrErrors=new KD.utils.Hash();KD.utils.ClientManager.clearInvalidSessionRequest();fnctnSuccess(response);};if(synchronous===true){KD.utils.Action._makeSyncRequest(path,callback);}else{var params=KD.utils.ClientManager.getInvalidSessionRequest();if(params[1]!==null&&params[2]!==null&&params[3]!==null){Connect.setDefaultPostHeader(false);Connect.initHeader("Cache-Control","no-cache, no-store");Connect.initHeader("Pragma","no-cache");Connect.initHeader("Expires","-1");Connect.asyncRequest(params[1],params[2],params[3]);}}}};this._makeSyncRequest=function(path,callback){var oXhr,xhr,xhrTimeout,oResponse;oXhr=KD.utils.Action._createSyncXhr();if(oXhr){xhr=oXhr.xhr;xhr.open("GET",path,false);xhrTimeout=setTimeout(function(){xhr.abort();},callback.argument[0].timeout||30000);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("Cache-Control","no-cache, no-store");xhr.setRequestHeader("Pragma","no-cache");xhr.setRequestHeader("Expires","-1");try{xhr.send(null);}catch(e){callback.failure({status:0,statusText:"Communication Failure",argument:callback.argument});}if(xhr.readyState==4){clearTimeout(xhrTimeout);oResponse=KD.utils.Action._buildSyncResponse(xhr,callback.argument);if(xhr.status!=200){callback.failure(oResponse);return;}if(callback.success===KD.utils.Action._setFieldsCallback){callback.success(oResponse);}else{callback.success(oResponse);}}}else{alert("Your browser does not support AJAX requests.");}};this.getMultipleRequestRecords=function(o){var records,xml,parser,text;try{records=o.responseXML.getElementsByTagName("record");if(records.length==0){if(o.responseXML!=null&&o.responseXML.xml!=null&&o.responseXML.xml.length==0){throw"rebuild ie xml";}}}catch(e){if(o.responseText&&o.responseText.length>0){text=o.responseText;text=text.replace(/[^\u0009-\u000d\u0020-\uffff]*/gi,"");if(window.DOMParser){parser=new DOMParser();xml=parser.parseFromString(text,"text/xml");}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(text);}try{records=xml.getElementsByTagName("record");}catch(e2){}}}return records;};this.getSingleRequestRecord=function(o){try{return o.responseXML.getElementsByTagName("record")[0];}catch(e){}};this.getRequestName=function(o){try{return o.responseXML.getElementsByTagName("requestName")[0].firstChild.nodeValue;}catch(e){}};this.openDatePicker=function(evt,id){new YAHOO.KD.widget.CalendarPicker(evt,id,"d");};this.openDateTimePicker=function(evt,id){new YAHOO.KD.widget.CalendarPicker(evt,id,"dt");};this.dateSelected=function(evt,dateArr,params){var datePart,nullDate=false,qstnId=params[0];if(dateArr&&dateArr[0]&&dateArr[0][0]){datePart=dateArr[0][0];}else{datePart=dateArr;}if(datePart==null){nullDate=true;}var hour=Dom.get("hour_"+qstnId);if(hour){KD.utils.Action.setDateTimeFields(qstnId,datePart,nullDate);}else{KD.utils.Action.setDateFields(qstnId,datePart,nullDate);}};this.updateDate=function(el){var qstnId=KD.utils.Util.getIDPart(el.id);var qstn=KD.utils.Util.getElementObject(qstnId,"SRVQSTN_");var yr=Dom.get("year_"+qstnId).value;var month=Dom.get("month_"+qstnId).value;var day=Dom.get("day_"+qstnId).value;if(el.value==null||el.value==""){KD.utils.Action.setDateFields(qstnId,null,true);return;}if(yr&&month&&month!=""&&day&&day!=""){KD.utils.Action.setDateFields(qstnId,[yr,month,day]);}};this.updateDateTime=function(el){var qstnId=KD.utils.Util.getIDPart(el.id);var qstn=KD.utils.Util.getElementObject(qstnId,"SRVQSTN_");var yr=Dom.get("year_"+qstnId).value;var month=Dom.get("month_"+qstnId).value;var day=Dom.get("day_"+qstnId).value;var hour=Dom.get("hour_"+qstnId).value;var min=Dom.get("min_"+qstnId).value;var ampm=Dom.get("ampm_"+qstnId).value;var local=Dom.get("local_"+qstnId);if(el.id.indexOf("hour_")!=-1||el.id.indexOf("min_")!=-1||el.id.indexOf("ampm_")!=-1){if(el.value==null||el.value==""){KD.utils.Action.setDateTimeFields(qstnId,null,false,true);return;}}if(el.value==null||el.value==""){KD.utils.Action.setDateTimeFields(qstnId,null,true);return;}var tempHr=0;if(hour&&hour!=""){tempHr=parseInt(hour,10);if(tempHr<12&&ampm==="PM"){tempHr+=12;}if(tempHr>=12&&ampm!=="PM"){tempHr-=12;}}var parts=[yr,month,day];parts[parts.length]=tempHr;parts[parts.length]=min||0;parts[parts.length]=0;KD.utils.Action.setDateTimeFields(qstnId,parts,false,false);};this.setDateFields=function(labelId,dateArr,nullThis){var qstn=KD.utils.Util.getElementObject(labelId,"SRVQSTN_");if(!qstn){alert("function setDateFields - Unable to locate any input elements for :"+labelId);return;}var qstnId=qstn.id.slice("SRVQSTN_".length);var hour=Dom.get("hour_"+qstnId);if(hour){KD.utils.Action.setDateTimeFields(labelId,dateArr,nullThis);return;}var originalValue=qstn.value;var yr=Dom.get("year_"+qstnId);var month=Dom.get("month_"+qstnId);var day=Dom.get("day_"+qstnId);var local=Dom.get("local_"+qstnId);
var date;if(qstn){if(nullThis){qstn.value="";yr.value="";month.selectedIndex=null;day.selectedIndex=null;if(local){local.value="";}if(originalValue&&originalValue!=""){KD.utils.Action._fireChange(qstn);}return;}if(!dateArr){if(qstn.value&&qstn.value!=""&&qstn.value.indexOf("-")!=-1){dateArr=qstn.value.split("-");}else{if(month.options[0].value=="01"){date=new Date();dateArr=new Array();dateArr[0]=date.getFullYear();dateArr[1]=date.getMonth()+1;dateArr[2]=date.getDate();}else{return;}}}else{if(dateArr.length<3){date=new Date();dateArr=new Array();dateArr[0]=date.getFullYear();dateArr[1]=date.getMonth()+1;dateArr[2]=date.getDate();}}yr.value=dateArr[0];month.value=KD.utils.Util.padZeros(dateArr[1],2);day.value=KD.utils.Util.padZeros(dateArr[2],2);qstn.value=KD.utils.Util.formatDate(dateArr);if(local){local.value=KD.utils.Util.formatLocalDate(dateArr);}if(originalValue!=qstn.value&&clientManager.isLoading==false){KD.utils.Action._fireChange(qstn);}}};this.setDateTimeFields=function(labelId,localDateArr,nullThis,nullTime){var qstn=KD.utils.Util.getElementObject(labelId,"SRVQSTN_");if(!qstn){alert("function setDateTimeFields - Unable to locate any input elements for :"+labelId);return;}var qstnId=qstn.id.slice("SRVQSTN_".length);var originalValue=qstn.value;var yr=Dom.get("year_"+qstnId);var month=Dom.get("month_"+qstnId);var day=Dom.get("day_"+qstnId);var hour=Dom.get("hour_"+qstnId);var min=Dom.get("min_"+qstnId);var sec="00";var ampm=Dom.get("ampm_"+qstnId);var local=Dom.get("local_"+qstnId);var timeArr;var ampmValue="AM";var date;var utcDateArr;var parts;if(qstn){if(nullThis){qstn.value="";yr.value="";month.selectedIndex=null;day.selectedIndex=null;hour.selectedIndex=null;min.selectedIndex=null;sec="";ampm.selectedIndex=null;if(local){local.value="";}if(originalValue&&originalValue!=""){KD.utils.Action._fireChange(qstn);}return;}if(nullTime){hour.selectedIndex=null;min.selectedIndex=null;sec="";ampm.selectedIndex=null;if(qstn.value!=null&&qstn.value!=""){if(qstn.getAttribute("required")=="true"){parts=[yr.value,month.value,day.value];}else{parts=[yr.value,month.value,day.value,0,0,0];}qstn.value=KD.utils.Util.formatUTCDateTime(parts);if(local){local.value=KD.utils.Util.formatLocalDateTime(parts);}}if(originalValue&&originalValue!=""){KD.utils.Action._fireChange(qstn);}return;}if(localDateArr&&localDateArr.length>=3){if(ampm.value!=""){ampmValue=ampm.value;}timeArr=new Array();if(hour.value!=""){timeArr[0]=hour.value;if(hour.value<12&&ampmValue=="PM"){timeArr[0]=parseInt(timeArr[0],10)+12;}if(hour.value==12&&ampmValue=="AM"){timeArr[0]=0;}}else{timeArr[0]=0;}if(min.value!=""){timeArr[1]=min.value;}else{timeArr[1]=0;}if(sec!=""){timeArr[2]=sec;}else{timeArr[2]=0;}var nH=parseInt(localDateArr[3],10);localDateArr[3]=isNaN(nH)?timeArr[0]:nH;var nM=parseInt(localDateArr[4],10);localDateArr[4]=isNaN(nM)?timeArr[1]:nM;var nS=parseInt(localDateArr[5],10);localDateArr[5]=isNaN(nS)?sec:nS;}else{if(!localDateArr){if(qstn.value&&qstn.value!=""&&qstn.value.indexOf("-")!=-1&&qstn.value.indexOf(":")!=-1){utcDateArr=KD.utils.Util.parseDtString(qstn.value);date=new Date();date.setUTCFullYear(utcDateArr[0]);date.setUTCMonth(utcDateArr[1]-1);date.setUTCDate(utcDateArr[2]);date.setUTCHours(utcDateArr[3]);date.setUTCMinutes(utcDateArr[4]);date.setUTCSeconds(utcDateArr[5]);localDateArr=KD.utils.Util.getDtParts(date);}else{if(month.options[0].value=="01"){date=new Date();date.setSeconds(0);date.setMilliseconds(0);localDateArr=KD.utils.Util.getDtParts(date);}else{return;}}}else{if(localDateArr.length<3){date=new Date();date.setSeconds(0);date.setMilliseconds(0);localDateArr=KD.utils.Util.getDtParts(date);}}}ampmValue=parseInt(localDateArr[3],10)>=12?"PM":"AM";localDateArr[6]=ampmValue;var displayHr=parseInt(localDateArr[3],10);if(displayHr>12){displayHr-=12;}if(displayHr==0){displayHr=12;}yr.value=localDateArr[0];month.value=KD.utils.Util.padZeros(localDateArr[1],2);day.value=KD.utils.Util.padZeros(localDateArr[2],2);hour.value=KD.utils.Util.padZeros(displayHr,2);min.value=KD.utils.Util.padZeros(localDateArr[4],2);sec=KD.utils.Util.padZeros(localDateArr[5],2);ampm.value=localDateArr[6];qstn.value=KD.utils.Util.formatUTCDateTime(localDateArr);if(local){local.value=KD.utils.Util.formatLocalDateTime(localDateArr);}if(originalValue!=qstn.value&&clientManager.isLoading==false){KD.utils.Action._fireChange(qstn);}}};this.getRequestValue=function(record,name){if(record){var fields=record.getElementsByTagName("field");for(var i=0;i<fields.length;i++){if(fields[i].getAttribute("id")==name){if(fields[i].childNodes.length>0){return fields[i].firstChild.nodeValue;}else{return"";}}}}return"";};this._iterActionCall=function(nodeRef,fn){for(var j=0;j<nodeRef.childNodes.length;j++){var thisNode=nodeRef.childNodes[j];if((thisNode.id)&&(KD.utils.Util.getElementType(thisNode.id))=="Question"){var questionId=KD.utils.Util.getIDPart(thisNode.id);fn.call(KD.utils.Action,questionId);}else{if(thisNode.nodeName=="DIV"){KD.utils.Action._iterActionCall(thisNode,fn);}}}};this._standardActionCall=function(evt,clientAction,fn){clientAction.currEvent=KD.utils.Util.cloneObj(evt);var obj=YAHOO.util.Event.getTarget(evt);var valid=true;if(clientAction.ifExpr){var expr=KD.utils.Util.trimString(clientAction.ifExpr);if(expr!=""){valid=eval("("+expr+")");}}if(valid){var fields=clientAction.params;for(var i=0;i<fields.length;i++){fn.call(KD.utils.Action,fields[i]);}}};this._makeReadOnly=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.setReadOnly);};this._makeReadWrite=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.setReadWrite);};this._hideInPlace=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.hideElementInPlace);};this._showInPlace=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.showElementInPlace);};this._insert=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.insertElement);
};this._remove=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.removeElement);};this._makeRequired=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.makeQuestionRequired);};this._makeOptional=function(evt,clientAction){KD.utils.Action._standardActionCall(evt,clientAction,KD.utils.Action.makeQuestionOptional);};this._setFieldValues=function(evt,clientAction){var obj,valid,expr,qualParams,rqtParamString,connection;clientAction.currEvent=KD.utils.Util.cloneObj(evt);obj=YAHOO.util.Event.getTarget(evt);if(clientManager.submitType!=="ReviewRequest"){clientAction.currEvent=KD.utils.Util.cloneObj(evt);valid=true;if(clientAction.ifExpr){expr=KD.utils.Util.trimString(clientAction.ifExpr);if(expr!=""){valid=eval("("+expr+")");}}if(valid){qualParams=clientAction.params[0];rqtParamString=KD.utils.Action._buildParamString(qualParams);if(clientAction.source=="bridge"){KD.utils.Action.makeAsyncBridgeRequest("Set Fields - External",clientAction.actionId,rqtParamString,{success:KD.utils.Action._setFieldsCallback,failure:function(response){var message=response.getResponseHeader["X-Error-Message"];if(message==null){message="There was a problem executing a set fields event.";}KD.utils.Action.displayError(message,response);},argument:[clientAction]});}else{connection=new KD.utils.Callback(KD.utils.Action._setFieldsCallback,KD.utils.Action._setFieldsCallback,clientAction);KD.utils.Action.makeAsyncRequest("setFieldValues",clientAction.actionId,connection,rqtParamString,"",!clientAction.useGetEntry,clientAction.synchronous);}}}};this._buildParamString=function(qualParams){var rqtParamString="",len=0,thisParam,label,value,i;if(qualParams){len=qualParams.length;}if(len>0){for(i=0;i<len;i++){thisParam=qualParams[i];if(thisParam){label=thisParam.split(";")[1];value="";if(thisParam.indexOf(";BASE</FLD>")>0){value=eval(label);rqtParamString+="&"+encodeURIComponent(label)+"="+encodeURIComponent(value);}else{if(thisParam.indexOf(";ANSWER</FLD>")>0){value=KD.utils.Action.getQuestionValue(label);rqtParamString+="&"+encodeURIComponent(label)+"="+encodeURIComponent(value);}}}}}return rqtParamString;};this._setFieldsCallback=function(o,recordIndex){var recordXML,clientAction=o.argument[0],records=KD.utils.Action.getMultipleRequestRecords(o),fMap,setFields,fireChange,setToNull,alertNoMatch,alertMsg,fireChangeArr,qstn,id,action,i,j,field,value,elements,bridgeAttributeValues,attributePattern,match;action=eval("("+clientAction.params[1]+")");if(records==null||records.length==0){if(action){setToNull=action.nullOnNoMatch;alertNoMatch=action.alertOnNoMatch;alertMsg=action.alertMsg;recordXML="";}if(alertNoMatch){if(alertMsg==null||alertMsg.length==0){alertMsg="No records matched the input value.";}alert(alertMsg);}if(!setToNull){KD.utils.ClientManager.onSetFieldsReturn.fire(clientAction);return;}}if(records.length>1&&recordIndex==null){recordXML=KD.utils.Action._openSelectionDialog(o);return;}if(records.length>1&&recordIndex){recordXML=records[recordIndex];}else{recordXML=recordXML||records[0];}if(action){setFields=action.SetFields;fireChangeArr=[];bridgeAttributeValues=null;for(i=0;i<setFields.length;i++){for(field in setFields[i]){if(typeof setFields[i][field]==="string"){KD.utils.Action._handleSetReplace(field,setFields[i][field],recordXML);}else{fMap=setFields[i][field][field];fireChange=setFields[i][field]["fire"];if(clientAction.source==="bridge"){if(bridgeAttributeValues==null){bridgeAttributeValues={};if(recordXML!=null){elements=recordXML.getElementsByTagName("field");for(j=0;j<elements.length;j+=1){value=elements[j].textContent?elements[j].textContent:elements[j].text;bridgeAttributeValues[elements[j].getAttribute("id")]=value;}}}attributePattern=/<%=\s*attribute\["(.+?)"\]\s*%>/;value=fMap;match=attributePattern.exec(value);while(match!=null){value=value.replace(match[0],bridgeAttributeValues[match[1]]);match=attributePattern.exec(value);}fMap=value;}KD.utils.Action._handleSetReplace(field,fMap,recordXML,setToNull);if(fireChange==="true"){fireChangeArr.push(field);}if(fireChange==="immediate"){qstn=KD.utils.Util.getQuestionInput(field);if(qstn){KD.utils.Action._fireChange(qstn);}}}}}for(i=0;i<fireChangeArr.length;i++){id=fireChangeArr[i];qstn=KD.utils.Util.getQuestionInput(id);if(qstn){KD.utils.Action._fireChange(qstn);}}}KD.utils.ClientManager.onSetFieldsReturn.fire(clientAction);};this._openCalendarPicker=function(evt,id,calEl,cal){var theQuestion=KD.utils.Util.getQuestionInput(id);var topPos=0;var clickXY=Dom.getXY(YAHOO.util.Event.getTarget(evt));if(clickXY[1]-150>0){topPos=clickXY[1]-150;}var leftPos=clickXY[0]+25;if(leftPos+150>document.body.offsetWidth){leftPos=document.body.offsetWidth-150;}calEl.style.position="absolute";calEl.style.top=parseInt(topPos)+"px";calEl.style.left=parseInt(leftPos)+"px";var months=Dom.get("month_"+id).options;var months2=new Array();var offset=months.length-12;for(var i=offset;i<months.length;i++){months2[i-offset]=months[i].text;}if(theQuestion.value&&theQuestion.value!=""){var theDate=new Date();var parts=KD.utils.Util.parseDtString(theQuestion.value);if(parts.length>0){theDate.setYear(parts[0]);theDate.setMonth(parts[1]-1);theDate.setDate(parts[2]);cal.setYear(theDate.getFullYear());cal.setMonth(theDate.getMonth());}if(parts.length>3){theDate.setHours(parts[3]);theDate.setMinutes(parts[4]);theDate.setSeconds(parts[5]);cal.setHour(theDate.getHours());cal.setMinute(theDate.getMinutes());cal.setSecond(theDate.getSeconds());}cal.select(theDate);}cal.cfg.setProperty("HIDE_BLANK_WEEKS",true);cal.cfg.setProperty("MONTHS_LONG",months2);cal.cfg.setProperty("close",true);cal.selectEvent.subscribe(KD.utils.Action.dateSelected,[id,cal]);cal.render();cal.show();};this._openSelectionDialog=function(o){var recordXMLArray=KD.utils.Action.getMultipleRequestRecords(o),clientAction=o.argument[0],useAdvanced=true,classSuffix="",resultsTable,action,setFields;action=eval("("+clientAction.params[1]+")");if(action){setFields=action.SetFields;
if(setFields&&setFields.length){try{for(var field in setFields[0]){if(typeof setFields[0][field]==="string"){useAdvanced=false;}break;}}catch(e){}}if(useAdvanced){classSuffix="Adv";resultsTable=KD.utils.Action.showResultsAsAdvancedTable(recordXMLArray,setFields,clientAction.source);}else{resultsTable=KD.utils.Action.showResultsAsTable(recordXMLArray);}resultsTable.className+=" resultsTable"+classSuffix;var elementType=KD.utils.Util.getElementType(clientAction.elObj.id);var cfg={modal:true,draggable:false};if(elementType&&elementType.toUpperCase()!="PAGE"){cfg.context=[clientAction.elObj,"tl","bl"];}if(elementType&&elementType.toUpperCase()=="PAGE"){cfg.xy=[50,10];}var myDialogId="selectionLayer_"+clientAction.actionId;var myDialog=new YAHOO.widget.Panel(myDialogId,cfg);var recRows=KD.utils.Util.getElementsByClassName("record","tr",resultsTable);for(var r=0;r<recRows.length;r++){YAHOO.util.Event.addListener(recRows[r],"click",KD.utils.Action._selectItem,[o,r,myDialog]);YAHOO.util.Event.addListener(recRows[r],"mouseover",KD.utils.Action._mouseItem,[true]);YAHOO.util.Event.addListener(recRows[r],"mouseout",KD.utils.Action._mouseItem,[false]);}clientAction.elObj.blur();myDialog.setBody("<div class='multItemsHeader"+classSuffix+"'>Multiple Items Found (select one):</div>");if(resultsTable.offsetWidth<225){resultsTable.style.width="225px";}myDialog.appendToBody(resultsTable);myDialog.render(document.body);try{myDialog.focus();}catch(e){}var dlgWidth=(resultsTable.offsetWidth/Dom.getClientWidth());if(dlgWidth>0.6){myDialog.body.style.overflow="auto";myDialog.body.style.width=String(Dom.getClientWidth()/2)+"px";}}};this._mouseItem=function(evt,args){var isMouseOver=args[0];var thisEl=YAHOO.util.Event.getTarget(evt);if(thisEl.nodeName=="TD"){thisEl=thisEl.parentNode;}if(thisEl.nodeName=="DIV"){thisEl=thisEl.parentNode.parentNode;}if(isMouseOver){thisEl.setAttribute("previousClass",thisEl.className);thisEl.className="resultsTableHover";}else{var prevCls=thisEl.getAttribute("previousClass");if(prevCls!=null){thisEl.className=prevCls;}}};this._selectItem=function(type,args){var myDialog=args[2];myDialog.hide();if(args[0]!=null&&args[1]!=null){KD.utils.Action._setFieldsCallback(args[0],args[1]);}myDialog.destroy();};this._setInternalFieldValues=function(evt,clientAction){var obj,valid,expr,action,setFields,i,field;clientAction.currEvent=KD.utils.Util.cloneObj(evt);obj=YAHOO.util.Event.getTarget(evt);if(clientManager.submitType!=="ReviewRequest"){valid=true;clientAction.currEvent=KD.utils.Util.cloneObj(evt);if(clientAction.ifExpr){expr=KD.utils.Util.trimString(clientAction.ifExpr);if(expr!=""){valid=eval("("+expr+")");}}if(valid){try{action=eval("("+clientAction.params[1]+")");}catch(err){alert(err.description);}if(action){setFields=action.SetFields;var fireChangeArr=[];for(i=0;i<setFields.length;i+=1){for(field in setFields[i]){if(typeof setFields[i][field]==="string"){KD.utils.Action._handleSetReplace(field,setFields[i][field]);}else{var fMap=setFields[i][field][field];var fireChange=setFields[i][field]["fire"];KD.utils.Action._handleSetReplace(field,fMap);if(fireChange==="true"){fireChangeArr.push(field);}}}}for(i=0;i<fireChangeArr.length;i++){var id=fireChangeArr[i];var qstn=KD.utils.Util.getQuestionInput(id);if(qstn){KD.utils.Action._fireChange(qstn);}}}}}};this._attachMenu=function(evt,clientAction){var obj,valid,expr,action,attachMenu,selectObj,val,option,qualParams,rqtParamString,connection;clientAction.currEvent=KD.utils.Util.cloneObj(evt);obj=YAHOO.util.Event.getTarget(evt);valid=true;if(clientAction.ifExpr){expr=KD.utils.Util.trimString(clientAction.ifExpr);if(expr!=""){valid=eval("("+expr+")");}}if(clientManager.submitType==="ReviewRequest"){action=eval("("+clientAction.params[1]+")");if(action){attachMenu=action.AttachMenu[0];selectObj=KD.utils.Util.getQuestionInput(attachMenu.AttachTo);if(selectObj){val=selectObj.getAttribute("originalValue");if(val&&val!="null"){option=document.createElement("option");option.text=val;option.value=val;try{selectObj.add(option,null);}catch(ex){selectObj.add(option);}try{selectObj.options[selectObj.length-1].setAttribute("selected","true");selectObj.value=selectObj.options[selectObj.length-1].value;}catch(ex1){}}}}valid=false;}if(valid){qualParams=clientAction.params[0];rqtParamString=KD.utils.Action._buildParamString(qualParams);if(clientAction.source=="bridge"){KD.utils.Action.makeAsyncBridgeRequest("Populate Menu",clientAction.actionId,rqtParamString,{success:KD.utils.Action._attachMenuCallback,failure:function(response){var message=response.getResponseHeader["X-Error-Message"];if(message==null){message="There was a problem executing a set fields event.";}KD.utils.Action.displayError(message,response);},argument:[clientAction]});}else{connection=new KD.utils.Callback(KD.utils.Action._attachMenuCallback,KD.utils.Action._attachMenuCallback,clientAction);clientAction.isOnLoad=clientManager.isLoading;KD.utils.Action.makeAsyncRequest("attachMenu",clientAction.actionId,connection,rqtParamString,"",!clientAction.useGetEntry,true);}}};this._attachMenuCallback=function(o){var clientAction=o.argument[0];var recordsXML=KD.utils.Action.getMultipleRequestRecords(o);if(recordsXML){var action=eval("("+clientAction.params[1]+")");if(action){var attachMenu=action.AttachMenu[0];var optionValueField,optionTextField;if(clientAction.source=="bridge"){optionValueField=attachMenu.ValueField;optionTextField=attachMenu.LabelField;}else{var oOptionValue=attachMenu.ValueField.split(";");optionValueField=oOptionValue[1];var oOptionLabel=attachMenu.LabelField.split(";");optionTextField=oOptionLabel[1];}var targetList=KD.utils.Util.getQuestionInput(attachMenu.AttachTo);for(var h=targetList.options.length-1;h>=0;h--){targetList.remove(h);}var blankOption=document.createElement("option");blankOption.setAttribute("value","");targetList.appendChild(blankOption);targetList.style.width="1";var uniqueValueHash=new KD.utils.Hash();for(var i=0;i<recordsXML.length;i++){var optionValue=KD.utils.Util._escapeSpecialChars(KD.utils.Action.getRequestValue(recordsXML[i],optionValueField));
var optionText=KD.utils.Action.getRequestValue(recordsXML[i],optionTextField);var checkExists=uniqueValueHash.getItem(optionValue+"--"+optionText);if(checkExists==null){var newOption=document.createElement("option");newOption.setAttribute("value",optionValue);newOption.appendChild(document.createTextNode(optionText));targetList.appendChild(newOption);uniqueValueHash.setItem(optionValue+"--"+optionText,optionValue);}}targetList.style.width="auto";targetList.setAttribute("menuAttached","true");}KD.utils.Action.setQuestionValue(attachMenu.AttachTo,targetList.getAttribute("originalValue"));}KD.utils.ClientManager.onAttachMenu.fire(clientAction);};this._handleSetReplace=function(destElId,rawValue,recordXML,setToNull){var value="";if(setToNull){value="$NULL$";}else{var flds=rawValue.split("</FLD>");for(var i=0;i<flds.length;i++){if(flds[i].indexOf("<FLD>")==-1){value+=flds[i];}else{var segs=flds[i].split("<FLD>");if(segs.length>1){value+=segs[0];}if(recordXML){var fieldName=(flds[i].split(";")[0]).substring(flds[i].indexOf("<FLD>")+5);value+=KD.utils.Action.getRequestValue(recordXML,fieldName);}else{var instId=flds[i].split(";")[1];value+=KD.utils.Action.getQuestionValue(instId);}}}}value=value.replace(/__&#39;__/gi,"'");KD.utils.Action.setQuestionValue(destElId,KD.utils.Util.trimString(value));};this._addInnerHTML=function(o){var elId=o.argument[0];if(elId&&elId.length){elId=elId[0];}var el=Dom.get(elId);if(el){if(o.responseText&&o.responseText.indexOf("<errorMessage>")!=-1&&o.responseText.indexOf("invalid session")!=-1){var yes=confirm("Your session has timed out.  Would you like to reload the page?");if(yes){window.location.reload(true);}}var htmlString=o.responseText;el.innerHTML=htmlString;}};this._fireChange=function(el){if(el.dispatchEvent){var evt=document.createEvent("HTMLEvents");evt.initEvent("change",true,true);el.dispatchEvent(evt);}else{el.fireEvent("onchange");}};this._customAction=function(evt,clientAction){clientAction.currEvent=KD.utils.Util.cloneObj(evt);if(evt){var obj=YAHOO.util.Event.getTarget(evt);}var valid=true;try{if(clientAction.ifExpr){var expr=KD.utils.Util.trimString(clientAction.ifExpr);if(expr!=""){valid=eval("("+expr+")");}}if(valid){return eval(clientAction.params[0]);}}catch(error){alert("There was an error with the custom javascript:"+error);}};this._setFileLink=function(qstnEl){var link=Dom.get(qstnEl.getAttribute("id")+"_link");if(link){var qstn=link.parentNode;qstn.removeChild(link);}if(qstnEl.value&&qstnEl.value!=""){link=document.createElement("a");link.setAttribute("id",qstnEl.getAttribute("id")+"_link");link.setAttribute("target","_blank");var sessionId=encodeURIComponent(KD.utils.ClientManager.sessionId);var now=new Date();var questionId=encodeURIComponent(KD.utils.Util.getIDPart(qstnEl.getAttribute("id")));var path="SimpleDataRequest?requestName=getFile&dataRequestId=attachment&sessionId="+sessionId+"&questionId="+questionId+"&noCache="+now.getTime()+"&fileName="+encodeURIComponent(qstnEl.value);link.setAttribute("href",path);link.className="fileLink";link.style.marginRight="20px";var fileName=document.createTextNode(qstnEl.value);link.appendChild(fileName);qstnEl.originalDisplay=qstnEl.style.display;qstnEl.style.display="none";var qstnLyr=qstnEl.parentNode;var first=qstnLyr.firstChild;qstnLyr.insertBefore(link,first);}else{if(!qstnEl.originalDisplay||!qstnEl.originalDisplay==""){qstnEl.originalDisplay="inline";}qstnEl.style.display=qstnEl.originalDisplay;}};this.submissionLock=function(csrv,options){options=KD.utils.Action._buildSubmissionLockOptions(options,"lock");KD.utils.Action._doSubmissionLockAction(csrv,options);};this.submissionUnlock=function(csrv,options){options=KD.utils.Action._buildSubmissionLockOptions(options,"unlock");KD.utils.Action._doSubmissionLockAction(csrv,options);};this.isSubmissionLocked=function(csrv,options){options=KD.utils.Action._buildSubmissionLockOptions(options,"isLocked");KD.utils.Action._doSubmissionLockAction(csrv,options);};this.isSubmissionLockedByMe=function(csrv,options){options=KD.utils.Action._buildSubmissionLockOptions(options,"isLockedByMe");KD.utils.Action._doSubmissionLockAction(csrv,options);};this._submissionLock=function(evt,clientAction){KD.utils.Action._submissionLockUnlockCheck(evt,clientAction);};this._submissionUnlock=function(evt,clientAction){KD.utils.Action._submissionLockUnlockCheck(evt,clientAction);};this._buildSubmissionLockOptions=function(options,action){if(typeof options==="string"){KD.utils.Action.validateJsonLoaded();options=YAHOO.lang.JSON.parse(options);}options=options||{};if(action){options.action=action;}return options;};this._submissionLockUnlockCheck=function(evt,clientAction){clientAction.currEvent=KD.utils.Util.cloneObj(evt);var expr,options,valid=true;if(clientAction.ifExpr){expr=KD.utils.Util.trimString(clientAction.ifExpr);if(expr!=""){valid=eval("("+expr+")");}}if(valid){options=KD.utils.Action._buildSubmissionLockOptions(clientAction.params[0]);KD.utils.Action._doSubmissionLockAction(clientManager.customerSurveyId,options);}};this._removeSubmitButtons=function(){var i=0,buttons=KD.utils.Util.getElementsByClassName("templateButtonLayer","div","pageQuestionsForm");KD.utils.Action._disableButtonEvents();for(i=0;i<buttons.length;i+=1){buttons[i].parentNode.removeChild(buttons[i]);}};this._disableButtonEvents=function(e){var buttons=KD.utils.ClientManager.submitButtons,buttonDiv,buttonEls,theButton;KD.utils.ClientManager.buttonListeners={};for(var i=0;i<buttons.length;i+=1){buttonDiv=Dom.get("BUTTON_"+buttons[i]);buttonEls=KD.utils.Util.getElementsByClassName("templateButton","input",buttonDiv);if(buttonEls&&buttonEls.length>0){theButton=buttonEls[0];YAHOO.util.Event.removeListener(theButton,"click");}}};this._enableButtonEvents=function(e){var buttons=KD.utils.ClientManager.submitButtons,buttonDiv,buttonEls,theButton;for(var i=0;i<buttons.length;i+=1){buttonDiv=Dom.get("BUTTON_"+buttons[i]);buttonEls=KD.utils.Util.getElementsByClassName("templateButton","input",buttonDiv);if(buttonEls&&buttonEls.length>0){theButton=buttonEls[0];
YAHOO.util.Event.addListener(theButton,"click",KD.utils.Action._submitButtonClick,[theButton.form,KD.utils.Util.getIDPart(buttonDiv.id)],true);}}KD.utils.ClientManager.buttonListeners={};};this._submitButtonClick=function(e,parms){if(KD.utils.ClientManager.isSubmitting!=true){var theForm=parms[0];var id=parms[1];KD.utils.ClientManager.isSubmitting=true;KD.utils.Action.disableButton(id);KD.utils.Action.validateForm(e,theForm);}};this._setFieldsEventHandler=function(origAction,clientAction,origEvent){if(origAction.elementId==clientAction.elementId){clientAction.action.apply(KD.utils.Action,[origEvent,clientAction]);}else{return;}};this._attachMenuEventHandler=function(origAction,clientAction,origEvent){var theEl=eval("("+origAction.params[1]+")");if(theEl&&theEl.AttachMenu&&theEl.AttachMenu[0].AttachTo==clientAction.elementId){clientAction.action.apply(KD.utils.Action,[origEvent,clientAction]);}};this._customEventHandler=function(type,origItems,clientAction){var origAction=origItems[0];if(!origAction){return;}var origEvent=origAction.currEvent;if(!origEvent){var theTarget=KD.utils.Util.getQuestionInput(origAction.elementId);origEvent={button:0,which:1,target:theTarget,type:origAction.jsEvent};}if(type=="onSetFieldsReturn"){KD.utils.Action._setFieldsEventHandler(origAction,clientAction,origEvent);}else{if(type=="onAttachMenu"){KD.utils.Action._attachMenuEventHandler(origAction,clientAction,origEvent);}}};this._createSyncXhr=function(){var obj={},oXhr=null,oAX=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];try{oXhr=new XMLHttpRequest();}catch(e){for(var i=0;i<oAX.length;i+=1){try{oXhr=new ActiveXObject(oAX[i]);break;}catch(e2){}}}obj.xhr=oXhr;return obj;};this._buildSyncResponse=function(xhr,callbackArg){var oRes={},oHeader={},headerStr,header,delimitPos;try{headerStr=xhr.getAllResponseHeaders();header=headerStr.split("\n");for(var i=0;i<header.length;i++){delimitPos=header[i].indexOf(":");if(delimitPos!=-1){oHeader[header[i].substring(0,delimitPos)]=header[i].substring(delimitPos+2);}}}catch(e){}oRes.status=xhr.status;oRes.statusText=xhr.statusText;oRes.getResponseHeader=oHeader;oRes.getAllResponseHeaders=headerStr;oRes.responseText=xhr.responseText;oRes.responseXML=xhr.responseXML;if(typeof callbackArg!="undefined"){oRes.argument=callbackArg;}return oRes;};this.handleHttpErrorCode=function(statusCode,message){if(statusCode==401){KD.utils.ClientManager.renderSimpleLogin();}else{if(statusCode==0){alert("The web server hasn't responded in a reasonable amount of time.\nPlease try the request again.");}else{alert("Error: "+statusCode+"\n\n"+message);}}};this._doSubmissionLockAction=function(csrv,cfg){var configObj={action:"lock",responseFormat:"json",url:"SubmissionLock",timeout:10000,confirm:false,confirmMsg:"Are you sure?",nullCsrvMsg:"A submission id is required",authErrorMsg:"User is not authenticated"};for(var property in cfg){configObj[property]=cfg[property];}if(csrv===""){window.alert(configObj.nullCsrvMsg);return;}if(configObj.confirm===false||window.confirm(configObj.confirmMsg)){var AsyncRequest={success:function(o){var el;if(YAHOO.lang.isArray(o.argument)){el=YAHOO.util.Dom.get(o.argument[0]);}else{el=YAHOO.util.Dom.get(o.argument);}if(el){KD.utils.Action.validateJsonLoaded();var response=YAHOO.lang.JSON.parse(o.responseText);if(response.responseCode==="200"){KD.utils.Util.addClass(el,"responseOK");KD.utils.Util.removeClass(el,"responseError");}else{KD.utils.Util.addClass(el,"responseError");KD.utils.Util.removeClass(el,"responseOK");}el.innerHTML=response.responseMessage;}return o.responseText;},failure:function(o){this.success(o);},start:function(callback){var responseFormat=configObj.responseFormat.toLowerCase()==="xml"?"application/xml":"application/json";var parameters="csrv="+encodeURIComponent(csrv);parameters+="&action="+encodeURIComponent(configObj.action);parameters+="&nocache="+new Date().getTime();YAHOO.util.Connect.initHeader("Accept",responseFormat,true);YAHOO.util.Connect.initHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");YAHOO.util.Connect.asyncRequest("POST",configObj.url,callback,parameters);}};var callback={success:window[configObj.success]||AsyncRequest.success,failure:window[configObj.failure]||AsyncRequest.failure,scope:configObj.success?((configObj.scope)?configObj.scope:window):AsyncRequest,argument:configObj.argument||"message",timeout:configObj.timeout||10000,cache:false};AsyncRequest.start(callback);}};};}if(!KD.utils.FileLoader){KD.utils.FileLoader=new function(){this.questionObj=null;this.questionId=null;this.enforceFileTypes=false;this.fileTypesAllowed=null;this.sizeLimit=null;this.contextPath=null;this.loadFileWindow=null;this._getCenterWinFeatures=function(a,g){var c=window.screen.availWidth;var f=window.screen.availHeight;var e=parseInt(c/2)-(a/2);var d=parseInt(f/2)-(g/2);var b=",width="+a+",height="+g;b+=",top="+d+",left="+e;return b;};this.loadFile=function(a){if(!a){alert("Must include a question object");return false;}this.questionId=a.id.substring(a.id.indexOf("_")+1,a.id.length);this.questionObj=KD.utils.Util.getQuestionInput(this.questionId);if(KD.utils.Util.isArray(this.questionObj)){var b,c,e=this.questionObj.length;for(b=0;b<e;b++){c=this.questionObj[b].getAttribute("type");if(c&&c.toUpperCase()=="TEXT"){this.questionObj=this.questionObj[b];break;}}}if(this.questionObj.getAttribute("enforceFileTypes").toUpperCase()=="ENFORCE"){this.enforceFileTypes=true;}this.fileTypesAllowed=this.questionObj.getAttribute("fileTypesAllowed");this.sizeLimit=this.questionObj.getAttribute("sizeLimit");this.contextPath=KD.utils.ClientManager.webAppContextPath;var d=this._getCenterWinFeatures(500,200);var f=this.contextPath+"/resources/uploadFile.html";if(this.loadFileWindow&&!this.loadFileWindow.closed&&this.loadFileWindow.location){this.loadFileWindow.location.href=f;}else{this.loadFileWindow=window.open(f,"_blank",d);if(!this.loadFileWindow.opener){this.loadFileWindow.opener=self;}}if(window.focus){this.loadFileWindow.focus();
}};this.clearFile=function(d){this.questionID=d.id.substring(d.id.indexOf("_")+1,d.id.length);this.questionObj=KD.utils.Util.getQuestionInput(this.questionID);if(KD.utils.Util.isArray(this.questionObj)){var a,b,c=this.questionObj.length;for(a=0;a<c;a++){b=this.questionObj[a].getAttribute("type");if(b&&b.toUpperCase()=="TEXT"){this.questionObj=this.questionObj[a];break;}}}this.questionObj.value="";KD.utils.Action._setFileLink(this.questionObj);};};}if(!KD.utils.Callback){KD.utils.Callback=function(a,c,b,d){this.success=a;this.error=c;this.argument=new Array(b);this.includeLoadingImage=false;if(d){this.includeLoadingImage=d;}};}(function(){YAHOO.namespace("KD.widget");YAHOO.KD.widget.CalendarPicker=function(g,i,e){var l,f,t=e||"d",q="cal_"+i,s="calendarPanel_"+i;if(!l){function b(v){var u,d=null;if(f.getSelectedDates().length>0){u=f.getSelectedDates()[0];}else{u=null;}if(u instanceof Date){d=KD.utils.Util.getDtParts(u);}KD.utils.Action.dateSelected(v,d,[i]);l.hide();}function h(){l.hide();}function o(){f.deselectAll();f.render();}function c(){var u=f.getSelectedDates();var d;if(u.length>0){d=u[0];}else{d=f.today;}f.cfg.setProperty("pagedate",d);f.render();}var n={visible:false,context:[YAHOO.util.Event.getTarget(g),"tl","bl"],buttons:[{text:"Save",handler:b,isDefault:true},{text:"Cancel",handler:h}],draggable:false,close:true};var a=Dom.get("month_"+i);var k=a.options[0].value==""?true:false;if(k){n.buttons.push({text:"Clear",handler:o});}l=new YAHOO.widget.Dialog(i,n);l.setHeader(KD.utils.Util.getQuestionLabelValue(i));l.setBody('<div id="'+s+'"></div>');l.render(KD.utils.Util.getElementObject(i,"QLAYER_"));l.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){l.fireEvent("changeContent");}});}if(!f){var r={iframe:false,hide_blank_weeks:true,close:false};if(t=="dt"){f=new YAHOO.KD.widget.Calendar(q,s,r);}else{f=new YAHOO.widget.Calendar(q,s,r);}f.renderEvent.subscribe(function(){l.fireEvent("changeContent");});f.render();}var p,m=KD.utils.Action.getQuestionValue(i);if(m!=null&&m.length>0){if(t=="dt"){p=KD.utils.Util.utcFromLocal(m);}else{var j=m.split("-");p=new Date(j[0],j[1]-1,j[2]);}}else{if(t=="dt"){p=KD.utils.Util.utcFromLocal(new Date());p.setMinutes(0);p.setSeconds(0);}else{p=new Date();}}f.cfg.setProperty("pagedate",p);f.select(p);f.render();l.show();};YAHOO.KD.widget.Calendar=function(c,a,b){YAHOO.KD.widget.Calendar.prototype.hourEl=null;YAHOO.KD.widget.Calendar.prototype.minuteEl=null;YAHOO.KD.widget.Calendar.prototype.secondEl=null;YAHOO.KD.widget.Calendar.prototype.ampmEl=null;YAHOO.KD.widget.Calendar.prototype.time=[0,0,0];YAHOO.KD.widget.Calendar.superclass.constructor.call(this,c,a,b);YAHOO.KD.widget.Calendar.prototype.renderBody=function(e,d){YAHOO.KD.widget.Calendar.superclass.renderBody.call(this,e,d);d[d.length]="<tbody>";d[d.length]="<center>";d[d.length]='<table id="time_'+this.id+'" border="0" cellpadding="0" cellspacing="2" width="182px">';d[d.length]="<tbody>";d[d.length]='<tr class="cal_time">';d[d.length]='<td align="center"><input class="dt_hr_input" style="width:22px" name="hours" type="text" maxlength="2" size="1"></input></td>';d[d.length]='<td align="center">:</td>';d[d.length]='<td align="center"><input class="dt_min_input" style="width:22px" name="minutes" type="text" maxlength="2" size="1"></input></td>';d[d.length]='<td align="center">:</td>';d[d.length]='<td align="center"><input class="dt_sec_input" style="width:22px" name="seconds" type="text" maxlength="2" size="1"></input></td>';d[d.length]='<td align="center"><select class="dt_ampm_select" style="position:relative;">'+this.ampmOpts()+"</select></td>";d[d.length]="</tr>";d[d.length]="</tbody>";d[d.length]="</table>";d[d.length]="</center>";d[d.length]="</tbody>";return d;};YAHOO.KD.widget.Calendar.prototype.applyListeners=function(){YAHOO.KD.widget.Calendar.superclass.applyListeners.call(this);var n=this.getSelectedDates();var l=12,d=0,k=0,g="AM";if(n.length>0){var f=n[0];var j=f.getHours();if(j>12){l=j-12;g="PM";}else{if(j==12){l=j;g="PM";}else{if(j==0){l=12;}else{l=j;}}}d=f.getMinutes();k=f.getSeconds();}this.hourEl=YAHOO.util.Dom.getElementsByClassName("dt_hr_input","input",this.oDomContainer)[0];this.minuteEl=YAHOO.util.Dom.getElementsByClassName("dt_min_input","input",this.oDomContainer)[0];this.secondEl=YAHOO.util.Dom.getElementsByClassName("dt_sec_input","input",this.oDomContainer)[0];this.ampmEl=YAHOO.util.Dom.getElementsByClassName("dt_ampm_select","select",this.oDomContainer)[0];YAHOO.util.Event.addListener(this.hourEl,"change",this.setHoursListener,this,true);YAHOO.util.Event.addListener(this.minuteEl,"change",this.setMinutesListener,this,true);YAHOO.util.Event.addListener(this.secondEl,"change",this.setSecondsListener,this,true);YAHOO.util.Event.addListener(this.ampmEl,"change",this.setAmPmListener,this,true);this.hourEl.value=l;this.minuteEl.value=this.padZero(d,2);this.secondEl.value=this.padZero(k,2);for(var e=0;e<this.ampmEl.options.length;e+=1){if(this.ampmEl.options[e].text==g){this.ampmEl.selectedIndex=e;break;}}this.setHour(l);this.setMinute(d);this.setSecond(k);};YAHOO.KD.widget.Calendar.prototype.ampmOpts=function(){var d=[];d[d.length]='<option value="AM">AM</option>';d[d.length]='<option value="PM">PM</option>';return d.join();};YAHOO.KD.widget.Calendar.prototype.setHoursListener=function(d,f){var e=YAHOO.util.Event.getTarget(d);if(e){f.setHour(e.value);}};YAHOO.KD.widget.Calendar.prototype.setMinutesListener=function(d,f){var e=YAHOO.util.Event.getTarget(d);if(e){f.setMinute(e.value);}};YAHOO.KD.widget.Calendar.prototype.setSecondsListener=function(d,f){var e=YAHOO.util.Event.getTarget(d);if(e){f.setSecond(e.value);}};YAHOO.KD.widget.Calendar.prototype.setAmPmListener=function(d,f){var e=YAHOO.util.Event.getTarget(d);if(e){f.setAmPm(e.value);}};YAHOO.KD.widget.Calendar.prototype.setHour=function(d){var f=parseInt(d,10);if(isNaN(f)){return;}if(f<1||f>12){return;}var g=YAHOO.util.Dom.getElementsByClassName("dt_ampm_select","select",this.oDomContainer)[0];if(g==null){return;}var e=g.value;
if(e=="PM"){f+=12;if(f==24){f=12;}}else{if(f==12){f=0;}}this.time[0]=f;if(this.getSelectedDates().length>0){this.cfg.config.selected.value[0][3]=f;}};YAHOO.KD.widget.Calendar.prototype.setMinute=function(e){var d=parseInt(e,10);if(isNaN(d)){return;}if(d<0||d>59){return;}this.time[1]=d;if(this.getSelectedDates().length>0){this.cfg.config.selected.value[0][4]=d;}};YAHOO.KD.widget.Calendar.prototype.setSecond=function(d){var e=parseInt(d,10);if(isNaN(e)){return;}if(e<0||e>59){return;}this.time[2]=e;if(this.getSelectedDates().length>0){this.cfg.config.selected.value[0][5]=e;}};YAHOO.KD.widget.Calendar.prototype.setAmPm=function(d){var e="AM";if(d=="AM"||d=="PM"){e=d;}var g=YAHOO.util.Dom.getElementsByClassName("dt_hr_input","input",this.oDomContainer)[0];if(g==null){return;}var f=parseInt(g.value,10);if(isNaN(f)){return;}if(f<1||f>12){return;}if(e=="PM"){f+=12;if(f==24){f=12;}}else{if(f==12){f=0;}}this.time[0]=f;this.cfg.config.selected.value[0][3]=f;};YAHOO.KD.widget.Calendar.prototype.padZero=function(d,f){f=f||2;if(d!=null&&d!=undefined&&d.toString().length<f){for(var e=0;e<f-d.toString().length;e+=1){d="0"+d;}}return d;};YAHOO.KD.widget.Calendar.prototype._toDate=function(f){if(f instanceof Date){return f;}else{if(f&&f.length==3){return new Date(f[0],f[1]-1,f[2],f[3],f[4],f[5]);}else{if(f){var e=new Date(f[0],f[1]-1,f[2],f[3],f[4],f[5]);var d=KD.utils.Util.localFromUTC(e);return d;}}}};YAHOO.KD.widget.Calendar.prototype._toFieldArray=function(f){var e=[];if(f instanceof Date){e=[[f.getFullYear(),f.getMonth()+1,f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds()]];}else{if(YAHOO.lang.isString(f)){e=this._parseDates(f);}else{if(YAHOO.lang.isArray(f)){for(var g=0;g<f.length;++g){var h=f[g];e[e.length]=[h.getFullYear(),h.getMonth()+1,h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds()];}}}}return e;};YAHOO.KD.widget.Calendar.prototype.getSelectedDates=function(){var g=[];var f=this.cfg.getProperty(YAHOO.widget.Calendar._DEFAULT_CONFIG.SELECTED.key);for(var i=0;i<f.length;++i){var h=f[i];var e=new Date(h[0],h[1]-1,h[2],h[3],h[4],h[5]);g.push(e);}g.sort(function(j,d){return j-d;});return g;};YAHOO.KD.widget.Calendar.prototype.selectCell=function(g){var e=this.cells[g];var k=this.cellDates[g];var j=this._toDate(k);var f=YAHOO.util.Dom.hasClass(e,this.Style.CSS_CELL_SELECTABLE);if(f){this.beforeSelectEvent.fire();var i=YAHOO.widget.Calendar._DEFAULT_CONFIG.SELECTED.key;var h=this.cfg.getProperty(i);var d=k.concat();d[d.length]=this.time[0];d[d.length]=this.time[1];d[d.length]=this.time[2];if(this._indexOfSelectedFieldArray(d)==-1){h[h.length]=d;}if(this.parent){this.parent.cfg.setProperty(i,h);}else{this.cfg.setProperty(i,h);}this.renderCellStyleSelected(j,e);this.selectEvent.fire([d]);this.doCellMouseOut.call(e,null,this);}return this.getSelectedDates();};YAHOO.KD.widget.Calendar.prototype.select=function(i){var j,k,f,e=[],h=[];f=KD.utils.Util.localFromUTC(i);k=this.cfg.config.selected.key;j=this._toFieldArray(f);this.cfg.setProperty(YAHOO.widget.Calendar.DEFAULT_CONFIG.PAGEDATE.key,f);for(var d=0;d<j.length;++d){var g=j[d];if(!this.isDateOOB(this._toDate(g))){if(e.length===0){this.beforeSelectEvent.fire();h=this.cfg.getProperty(k);}e.push(g);if(this._indexOfSelectedFieldArray(g)==-1){h[h.length]=g;}}}if(e.length>0){if(this.parent){this.parent.cfg.setProperty(k,h);}else{this.cfg.setProperty(k,h);}this.selectEvent.fire(e);}return this.getSelectedDates();};};YAHOO.lang.extend(YAHOO.KD.widget.Calendar,YAHOO.widget.Calendar);})();
if(typeof Dom=="undefined"){Dom=YAHOO.util.Dom;}if(typeof KD=="undefined"){KD={};}if(typeof KD.utils=="undefined"){KD.utils={};}Date.prototype.setISO8601=function(d){var g=0,b,f,e=new Array(),c="^([0-9]{4})-?(0[1-9]|1[0-2])-?([12][0-9]|0[1-9]|3[01])(T?([01][0-9]|2[0-3]):?([0-5][0-9]):?([0-5][0-9])?.?([0-9]{3})?([zZ]|([+-])([01][0-9]|2[0-3]):?([0-5][0-9])?)?)?$",a=d.match(new RegExp(c));if(KD.utils.Util.isBlank(a[1])){return;}if(KD.utils.Util.isBlank(a[2])){return;}if(KD.utils.Util.isBlank(a[3])){return;}e[0]=parseInt(a[1],10);e[1]=parseInt(a[2],10)-1;e[2]=parseInt(a[3],10);e[3]=!KD.utils.Util.isBlank(a[5])?parseInt(a[5],10):0;e[4]=!KD.utils.Util.isBlank(a[6])?parseInt(a[6],10):0;e[5]=!KD.utils.Util.isBlank(a[7])?parseInt(a[7],10):0;e[6]=!KD.utils.Util.isBlank(a[8])?Number("0."+a[8])*1000:0;b=new Date(e[0],e[1],e[2],e[3],e[4],e[5],e[6]);if(!KD.utils.Util.isBlank(a[9])){g=(Number(a[11])*60)+Number(a[12]);g*=((a[10]=="-")?1:-1);}if(!KD.utils.Util.isBlank(a[5])){g-=b.getTimezoneOffset();}f=(Number(b)+(g*60*1000));this.setTime(Number(f));};String.prototype.startsWith=function(a){return(this.match("^"+a)==a);};if(!KD.utils.Util){KD.utils.Util=new function(){this.labelIDCache={};this.debugProperties=function(obj){if(obj){var props="Object Properties Available:\n";props+="Name: "+obj.name+"\n";props+="ID: "+obj.id+"\n";props+="Type: "+obj.type+"\n";for(var prop in obj){props+=prop+"="+eval("obj."+prop)+"\n";}alert(props);}else{alert("The object sent was null");}};this.getIDPart=function(id){if(!id){return null;}if(id.indexOf("QLAYER")!=-1){return id.substring("QLAYER_".length);}if(id.indexOf("QLABEL")!=-1){return id.substring("QLABEL_".length);}if(id.indexOf("QANSWER")!=-1){return id.substring("QANSWER_".length);}if(id.indexOf("QLAYER")!=-1){return id.substring("QLAYER_".length);}if(id.indexOf("DYNAMIC_TEXT")!=-1){return id.substring("DYNAMIC_TEXT_".length);}if(id.indexOf("IMAGE")!=-1){return id.substring("IMAGE_".length);}if(id.indexOf("BUTTON")!=-1){return id.substring("BUTTON_".length);}if(id.indexOf("SRVQSTN")!=-1){return id.substring("SRVQSTN_".length);}if(id.indexOf("SECTION")!=-1){return id.substring("SECTION_".length);}if(id.indexOf("PAGE")!=-1){return id.substring("PAGE_".length);}if(id.indexOf("month_")!=-1){return id.substring("month_".length);}if(id.indexOf("day_")!=-1){return id.substring("day_".length);}if(id.indexOf("year_")!=-1){return id.substring("year_".length);}if(id.indexOf("hour_")!=-1){return id.substring("hour_".length);}if(id.indexOf("min_")!=-1){return id.substring("min_".length);}if(id.indexOf("ampm_")!=-1){return id.substring("ampm_".length);}return id;};this.getElementFromObject=function(obj){return YAHOO.util.Event.getTarget(obj);};this.padZeros=function(obj,totalDigits){if(obj==null||typeof obj=="undefined"){return obj;}obj=obj.toString();var pd="";if(totalDigits>obj.length){for(var i=0;i<(totalDigits-obj.length);i++){pd+="0";}}return pd+obj.toString();};this.locateIDByLabel=function(parent,label,fullID){if(parent&&label){var children=parent.childNodes;for(var idx=0;idx<children.length;idx++){if(children[idx].attributes&&children[idx].getAttribute("label")==label){if(fullID){return children[idx].getAttribute("id");}else{return KD.utils.Util.getIDPart(children[idx].getAttribute("id"));}}if(children[idx].childNodes&&children[idx].childNodes.length>0){var id=KD.utils.Util.locateIDByLabel(children[idx],label,fullID);if(id!=""){return id;}}}}return"";};this.registerInCache=function(element,update){var label,id,idPart,i,qEls,el_label,type="",forceUpdate=typeof update==="undefined"?false:update;if(!element){return;}try{if(element.id){id=element.id;type=KD.utils.Util.getPrefixFromId(element.id)||"";}label=element.getAttribute("label");if(label&&label.length>0){if(forceUpdate||!KD.utils.Util.loadFromCache(label)){KD.utils.Util.setInCache(label,element);}if(forceUpdate||!KD.utils.Util.loadFromCache(type+label)){KD.utils.Util.setInCache(type+label,element);}}if(id&&id.length>0){idPart=KD.utils.Util.getIDPart(id);if(forceUpdate||!KD.utils.Util.loadFromCache(id)){KD.utils.Util.setInCache(id,element);}if(forceUpdate||!KD.utils.Util.loadFromCache(idPart)){KD.utils.Util.setInCache(idPart,element);}if(element.id.indexOf("QLAYER_")!=-1||element.id.indexOf("QANSWER_")!=-1){qEls=YAHOO.util.Dom.getElementsBy(function(obj){return(obj.id&&obj.id.length>0)?true:false;},"*",element);for(i=0;i<qEls.length;i++){el_label=qEls[i].getAttribute("label");if(!el_label){qEls[i].setAttribute("label",label);}KD.utils.Util.registerInCache(qEls[i]);}}}}catch(e){}};this.updateInCache=function(element){KD.utils.Util.registerInCache(element,true);};this.labelCache=function(key,element){this.key=key;this.element=element;};this.setInCache=function(key,element){KD.utils.Util.labelIDCache[key]=element;};this.isCacheIDEmpty=function(){return isEmpty(KD.utils.Util.labelIDCache);};this.loadFromCache=function(label){return KD.utils.Util.labelIDCache[label];};this.getPrefixFromId=function(id){var i,prefix="";if(id){i=id.indexOf("_");if(i>-1){prefix=id.slice(0,i+1);if(prefix=="DYNAMIC_"){prefix="DYNAMIC_TEXT_";}}}return prefix;};this.getPrefixFromType=function(type){if(!type){return"no type given";}if(type.indexOf("Question")!=-1){return"QLAYER_";}if(type.indexOf("Section")!=-1){return"SECTION_";}if(type.indexOf("Page")!=-1){return"PAGE_";}if(type.indexOf("Dynamic Text")!=-1){return"DYNAMIC_TEXT_";}if(type.indexOf("Button")!=-1){return"BUTTON_";}if(type.indexOf("Image")!=-1){return"IMAGE_";}return"unknown prefix";};this.getLabelFromAnswerEl=function(answerEl){var thisEl=answerEl;var theLabel="";while(thisEl){theLabel=thisEl.parentNode.getAttribute("label");if(theLabel&&theLabel!=""){return theLabel;}else{thisEl=thisEl.parentNode;}}return null;};this.getLabelValueFromAnswerEl=function(answerEl){var thisEl=answerEl,questionId;questionId=this.getIDPart(thisEl.id);return this.getQuestionLabelValue(questionId);};this.getQuestionId=function(label_id){var id,q=this.getElementObject(label_id);if(q){id=this.getIDPart(q.id);}return id;
};this.getElementObject=function(label_id,type){if(!type){type=KD.utils.Util.getPrefixFromType(KD.utils.ClientManager.getElementType(label_id));if(type=="no type given"){type="";}}var obj=KD.utils.Util.loadFromCache(type+label_id);return obj;};this.getAnswerLayer=function(label_id){var obj=KD.utils.Util.getElementObject(label_id,"QANSWER_");if(obj&&obj!=""){}else{alert("function ks_getAnswerLayer - Unable to locate the Object for: "+label_id);}return obj;};this.getQuestionLabel=function(label_id){var obj=KD.utils.Util.getElementObject(label_id,"QLABEL_");if(obj&&obj!=""){}else{alert("function getQuestionLabel - Unable to locate the Object for: "+label_id);}return obj;};this.getQuestionLabelValue=function(label){var obj,value="";if(label&&label.nodeType&&label.nodeType==1){obj=label;}else{obj=KD.utils.Util.getElementObject(label,"QLABEL_");}if(obj&&obj!=""){value=KD.utils.Util.trimString(obj.innerHTML);}return value;};this.getQuestionLayer=function(label_id){var obj=KD.utils.Util.getElementObject(label_id,"QLAYER_");if(obj&&obj!=""){}else{alert("function ks_getQuestionLayer - Unable to locate the Object for: "+label_id);}return obj;};this.getQuestionInput=function(label_id){var i,j,nodes,nodeTypes=["input","select","textarea"],ret=new Array(),obj=KD.utils.Util.getElementObject(label_id,"QANSWER_");if(obj){for(i=0;i<nodeTypes.length;i+=1){nodes=obj.getElementsByTagName(nodeTypes[i]);for(j=0;j<nodes.length;j+=1){if(nodes[j].id.startsWith("SRVQSTN_")){ret.push(nodes[j]);}}}}else{obj=Dom.get("SRVQSTN_"+label_id);if(obj){return obj;}else{return null;}}if(ret.length==1){return ret[0];}if(ret&&ret!=""){}else{alert("function getQuestionInput - Unable to locate any input elements for :"+label_id);}return ret;};this.getQuestionValue=function(label_id){var els=KD.utils.Util.getQuestionInput(label_id);if(els){if(!KD.utils.Util.isArray(els)){els=[els];}var thisVal="";var qstnType="";for(var i=0;i<els.length;i++){var cls=els[i].className;var thisID=els[i].getAttribute("id");if(cls&&(cls=="dateHidden"||cls=="dtHidden")){qstnType="Date";thisVal=els[i].value;break;}if(els[i].type&&(els[i].type&&els[i].type.toUpperCase()=="CHECKBOX")&&els[i].checked==true){qstnType="Checkbox";thisVal+=els[i].value+", ";thisVal=KD.utils.Util._unescapeSpecialChars(thisVal);continue;}else{if(els[i].type&&els[i].type.toUpperCase()=="RADIO"&&els[i].checked==true){thisVal=els[i].value;thisVal=KD.utils.Util._unescapeSpecialChars(thisVal);break;}else{if(els[i].tagName.toUpperCase()=="SELECT"){thisVal=els[i].value;thisVal=KD.utils.Util._unescapeSpecialChars(thisVal);break;}else{if((els[i].tagName.toUpperCase()=="INPUT"&&els[i].type.toUpperCase()=="TEXT")||els[i].tagName.toUpperCase()=="TEXTAREA"){thisVal=els[i].value;break;}}}}}if(qstnType=="Checkbox"&&thisVal.indexOf(",")!=-1){thisVal=KD.utils.Util.trimString(thisVal);thisVal=thisVal.substring(0,thisVal.length-1);}return thisVal;}else{alert("function KD.utils.Util.getQuestionValue - Unable to locate the Object for: "+label_id);return"";}};this.setQuestionValue=function(label_id,value){var nullThis=false;if(value==null||typeof value=="undefined"||value=="undefined"||value=="$NULL$"||value=="$NULL$"){nullThis=true;}var els=KD.utils.Util.getQuestionInput(label_id);if(els){if(KD.utils.Util._isDateQuestion(els)||KD.utils.Util._isDateTimeQuestion(els)){if(nullThis||value==""){KD.utils.Action.setDateFields(label_id,null,true);}else{var dateArr=[];if(typeof value=="string"){if(value.indexOf("-")!=-1){var utcDate=new Date();utcDate.setISO8601(value);dateArr[0]=utcDate.getFullYear();dateArr[1]=utcDate.getMonth()+1;dateArr[2]=utcDate.getDate();if(value.indexOf("T")!=-1){dateArr[3]=utcDate.getHours();dateArr[4]=utcDate.getMinutes();dateArr[5]=utcDate.getSeconds();}}else{if(value.indexOf("/")!=-1){var dtParts=value.split(" ");var remedyDateArr=dtParts[0].split("/");dateArr[0]=remedyDateArr[2];dateArr[1]=remedyDateArr[0];dateArr[2]=remedyDateArr[1];if(dtParts.length==2){var tParts=dtParts[1].split(":");dateArr=dateArr.concat(tParts);}}else{KD.utils.Action.setDateFields(label_id,null,true);return null;}}}else{if(KD.utils.Util.isArray(value)){dateArr=value;}}KD.utils.Action.setDateFields(label_id,dateArr);}return null;}if(KD.utils.Util.isArray(els)){for(var i=0;i<els.length;i++){if(nullThis){els[i].checked=false;continue;}value=KD.utils.Util._escapeSpecialChars(value);if(els[i].value==value){els[i].checked=true;return null;}}}else{if(els.type&&els.type.toUpperCase()=="CHECKBOX"||els.type.toUpperCase()=="RADIO"){if(nullThis){els.checked=false;return null;}value=KD.utils.Util._escapeSpecialChars(value);if(els.value==value){els.checked=true;}return null;}else{if(els.nodeName.toUpperCase()=="SELECT"&&els.options.length>0){if(nullThis){els.selectedIndex=0;els.options[0].setAttribute("selected","true");return null;}value=KD.utils.Util._escapeSpecialChars(value);for(i=0;i<els.options.length;i++){if(els.options[i].value==value){els.options[i].setAttribute("selected","true");els.selectedIndex=i;return null;}}}else{if(nullThis){value="";}else{if(els.nodeName.toUpperCase()=="TEXTAREA"){value=value.replace(/%0A/gi,"\n");value=value.replace(/%0D/gi,"\n");}}els.value=value;if(els.getAttribute("fileTypesAllowed")!=null){KD.utils.Action._setFileLink(els);}}}}}else{alert("function KD.utils.Util.setQuestionValue - Unable to locate the Object for: "+label_id);return false;}return true;};this.getTextObject=function(label_id){var obj=KD.utils.Util.getElementObject(label_id,"DYNAMIC_TEXT_");if(obj&&obj!=""){}else{alert("function ks_getTextObject - Unable to locate the Object for: "+label_id);}return obj;};this.getImageObject=function(label_id){var obj=KD.utils.Util.getElementObject(label_id,"IMAGE_");if(obj&&obj!=""){}else{alert("function ks_getImageObject - Unable to locate the Object for: "+label_id);}return obj;};this.getButtonObject=function(label_id){var obj=KD.utils.Util.getElementObject(label_id,"BUTTON_");if(obj&&obj!=""){}else{alert("function getButtonObject - Unable to locate the Object for: "+label_id);}return obj;
};this.isArray=function(obj){if(obj==null){return false;}return obj.constructor==Array;};this.trimString=function(sInString){sInString=sInString.replace(/^\s+/g,"");return sInString.replace(/\s+$/g,"");};this.isBlank=function(value){if(value==null||typeof value=="undefined"){return true;}if(KD.utils.Util.isArray(value)){return value.length==0;}if(value.constructor==Object){var hasProperty=false;for(var name in value){if(value.hasOwnProperty(name)&&!KD.utils.Util.isBlank(value[name])){hasProperty=true;break;}}return !hasProperty;}return value.toString().length==0;};this.getKeyPressed=function(evt){var key=YAHOO.util.Event.getCharCode(evt);return key;};this.getElementType=function(elId){if(elId.indexOf("QLAYER_")!=-1||elId.indexOf("SRVQSTN_")!=-1||elId.indexOf("QLABEL_")!=-1||elId.indexOf("QANSWER_")!=-1){return"Question";}if(elId.indexOf("SECTION_")!=-1){return"Section";}if(elId.indexOf("PAGE_")!=-1){return"Page";}if(elId.indexOf("DYNAMIC_TEXT")!=-1){return"Dynamic Text";}if(elId.indexOf("BUTTON_")!=-1){return"Button";}if(elId.indexOf("IMAGE_")!=-1){return"Image";}return"unknown type";};this.getCheckboxParentId=function(answerEl){var thisEl=answerEl;var parentId="";if(thisEl&&thisEl.type.toLowerCase()=="checkbox"){while(thisEl){parentId=thisEl.parentNode.getAttribute("id");if(parentId&&parentId!=""){parentId=parentId.replace("QANSWER_","");parentId=parentId.replace("QLABEL_","");return parentId;}else{thisEl=thisEl.parentNode;}}return null;}return null;};this.setCookie=function(cookieName,cookieValue,time){var today=new Date();var expire=new Date();expire.setTime(today.getTime()+time);document.cookie=cookieName+"="+escape(cookieValue)+";expires="+expire.toGMTString();};this.getCookieVal=function(offset){var endstr=document.cookie.indexOf(";",offset);if(endstr==-1){endstr=document.cookie.length;}return unescape(document.cookie.substring(offset,endstr));};this.getCookie=function(name){var arg=name+"=";var alen=arg.length;var clen=document.cookie.length;var i=0;while(i<clen){var j=i+alen;if(document.cookie.substring(i,j)==arg){return KD.utils.Util.getCookieVal(j);}i=document.cookie.indexOf(" ",i)+1;if(i==0){break;}}return null;};this.deleteCookie=function(name,path,domain){if(KD.utils.Util.getCookie(name)){document.cookie=name+"="+((path)?"; path="+path:"")+((domain)?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT";}};this.unloadCookie=function(){var pageID=Dom.get("pageID").value;KD.utils.Util.deleteCookie("KDCACHE-CHECK"+pageID);KD.utils.Util.setCookie("KD_PAGE",pageID,5000);};this.resetCachePageValues=function(){KD.utils.Util.unloadCookie();};this.checkCachePageLoad=function(){window.history.forward(1);var fromPage=KD.utils.Util.getCookie("KD_PAGE");if(fromPage&&fromPage!=""){KD.utils.Util.deleteCookie("KD_PAGE");return;}else{KD.utils.Util.checkCacheLoadStatus();}};this.checkCacheLoadStatus=function(){var pageID=Dom.get("pageID").value;if(!KD.utils.Util.getCookie("KDCACHE-CHECK"+pageID)){window.location.reload();}};this.cloneObj=function(obj,deep){if(obj==null||typeof(obj)!="object"){return obj;}var newObj=new Object();for(var prop in obj){try{if(deep){newObj[prop]=KD.utils.Util.cloneObj(obj[prop]);}else{newObj[prop]=obj[prop];}}catch(e){}}return newObj;};this.isDate=function(el){if(el){var id=KD.utils.Util.getIDPart(el.id);if(Dom.get("year_"+id)){return true;}}return false;};this._escapeSpecialChars=function(val){if(!val){return val;}var specialChars={"'":"%27"};var re;for(var key in specialChars){re=new RegExp(key,"g");val=val.toString().replace(re,specialChars[key]);}return val;};this._unescapeSpecialChars=function(val){if(!val){return val;}var specialChars={"%27":"'"};var re;for(var key in specialChars){re=new RegExp(key,"g");val=val.toString().replace(re,specialChars[key]);}return val;};this.getParameters=function(){var parms={},sUrl,pairs,pair,i;sUrl=window.location.search;if(sUrl){sUrl=sUrl.substr(1);pairs=sUrl.split("&");for(i=0;i<pairs.length;i+=1){pair=pairs[i].split("=");parms[pair[0]]=pair[1];}}return parms;};this.getParameter=function(key){var retVal=null;var parms=this.getParameters();if(parms[key]){retVal=parms[key];}return retVal;};this.isCheckboxItemChecked=function(label_id,cb_item){var cb=KD.utils.Util.getQuestionInput(label_id);if(cb){for(var i=0;i<cb.length;i++){if(cb[i].value===cb_item&&cb[i].checked){return true;}}}return false;};this.getElementsByClassName=function(className,tag,root,apply){return Dom.getElementsByClassName(className,tag,root,apply);};this.hasClass=function(el,className){return Dom.hasClass(el,className);};this.addClass=function(el,className){return Dom.addClass(el,className);};this.removeClass=function(el,className){return Dom.removeClass(el,className);};this.getAnswerType=function(answerField){answerField=Dom.get(answerField);if(answerField==null){return null;}return KD.utils.Util.isDate(answerField)?"date":answerField.nodeName.toString().toLowerCase()=="select"?"select":answerField.type;};this.formatTime=function(value){if(value==null||value==""||value.indexOf("M")!=-1){return value;}var ampm="AM";var parts=value.split(":");var h=parseInt(parts[0],10);if(h>=12){h-=12;ampm="PM";if(h==0){h=12;}}parts[0]=h;return(parts.join(":")+" "+ampm);};this.formatDate=function(values){var y,m,d,dt,dsep="-";if(values&&values.length&&values.length>=3){y=parseInt(values[0],10);if(!(y.toString().length==4)){return"";}m=parseInt(values[1],10);if(m>0&&m<=12){m=KD.utils.Util.padZeros(m,2);}else{return"";}d=parseInt(values[2],10);if(d>0&&d<=31){d=KD.utils.Util.padZeros(d,2);}else{return"";}dt=y+dsep+m+dsep+d;}else{dt="";}return dt;};this.parseDtString=function(dtStr){var localDate,dateParts,i,parts=[];if(dtStr==""){return parts;}if(dtStr.indexOf("T")!=-1){localDate=new Date();localDate.setISO8601(dtStr);parts[parts.length]=localDate.getUTCFullYear();parts[parts.length]=localDate.getUTCMonth()+1;parts[parts.length]=localDate.getUTCDate();parts[parts.length]=localDate.getUTCHours();parts[parts.length]=localDate.getUTCMinutes();parts[parts.length]=localDate.getUTCSeconds();
}else{dateParts=dtStr.split("-");if(dateParts.length>0){for(i=0;i<dateParts.length;i++){parts[parts.length]=parseInt(dateParts[i],10);}}}return parts;};this.getDtParts=function(dt){var parts=[];if(!(dt instanceof Date)){return[];}parts[0]=dt.getFullYear();parts[1]=dt.getMonth()+1;parts[2]=dt.getDate();parts[3]=dt.getHours();parts[4]=dt.getMinutes();parts[5]=dt.getSeconds();return parts;};this.getUTCDtParts=function(dt){var parts=[];if(!(dt instanceof Date)){return[];}parts[0]=dt.getUTCFullYear();parts[1]=dt.getUTCMonth()+1;parts[2]=dt.getUTCDate();parts[3]=dt.getUTCHours();parts[4]=dt.getUTCMinutes();parts[5]=dt.getUTCSeconds();return parts;};this.localFromUTC=function(utc){var offset,local,utcParts,dt=utc;if(typeof dt=="string"){utcParts=this.parseDtString(dt);dt=new Date(utcParts[0],utcParts[1]-1,utcParts[2],utcParts[3],utcParts[4],utcParts[5]);}if(dt instanceof Date){offset=dt.getTimezoneOffset()*60*1000;local=new Date(dt.getTime()-offset);return local;}else{return utc;}};this.utcFromLocal=function(dt){if(dt instanceof Date){var offset=dt.getTimezoneOffset()*60*1000;var utc=new Date(dt.getTime()+offset);return utc;}else{return dt;}};this.formatLocalDate=function(value){var dt,h,m,s,local;if(value instanceof Date){local=value;}else{if(value&&value.length&&value.length>=3){dt=KD.utils.Util.formatDate(value);if(dt==""){return dt;}local=new Date(parseInt(value[0],10),parseInt(value[1],10)-1,parseInt(value[2],10),0,0,0);}else{local="";}}if(local==null||local==""){return"";}dt=local.toLocaleDateString();return dt;};this.formatLocalDateTime=function(value,friendly){var dt,h,m,s,local,tsep=":",friendlyFormat=friendly===false?false:true;if(value instanceof Date){local=value;}else{if(value&&value.length&&value.length>=3){dt=KD.utils.Util.formatDate(value);if(dt==""){return dt;}h=parseInt(value[3],10);if(h<0||h>=24){h=0;}if(isNaN(h)){return"";}m=parseInt(value[4],10);if(m<0||m>=60){m=0;}if(isNaN(m)){return"";}s=parseInt(value[5],10);if(s<0||s>=60){s=0;}if(isNaN(s)){return"";}local=new Date(parseInt(value[0],10),parseInt(value[1],10)-1,parseInt(value[2],10),h,m,s);}else{local="";}}if(local==null||local==""){return"";}if(friendlyFormat){dt=local.toLocaleDateString()+" "+local.toLocaleTimeString();}else{var localDtParts=KD.utils.Util.getDtParts(local);dt=KD.utils.Util.formatDate(localDtParts)+"T"+KD.utils.Util.padZeros(localDtParts[3],2)+tsep+KD.utils.Util.padZeros(localDtParts[4],2)+tsep+KD.utils.Util.padZeros(localDtParts[5],2);var offset=local.getTimezoneOffset();var offsetSign=offset>0?"-":"+";var offsetH=parseInt(Math.abs(offset)/60,10);var offsetM=parseInt(Math.abs(offset)%60,10);dt+=offsetSign+KD.utils.Util.padZeros(offsetH,2)+tsep+KD.utils.Util.padZeros(offsetM,2);}return dt;};this.formatUTCDateTime=function(values){var dt,h,m,s,tsep=":";if(values&&values.length&&values.length>=3){dt=KD.utils.Util.formatDate(values);if(dt==""){return dt;}h=parseInt(values[3],10);if(h<0||h>=24){h=0;}if(isNaN(h)){return"";}m=parseInt(values[4],10);if(m<0||m>=60){m=0;}if(isNaN(m)){return"";}s=parseInt(values[5],10);if(s<0||s>=60){s=0;}if(isNaN(s)){return"";}var local=new Date(parseInt(values[0],10),parseInt(values[1],10)-1,parseInt(values[2],10),h,m,s);var utcDtParts=KD.utils.Util.getUTCDtParts(local);dt=KD.utils.Util.formatDate(utcDtParts)+"T"+KD.utils.Util.padZeros(utcDtParts[3],2)+tsep+KD.utils.Util.padZeros(utcDtParts[4],2)+tsep+KD.utils.Util.padZeros(utcDtParts[5],2)+"Z";}else{dt="";}return dt;};this.formatSimpleDateTime=function(dt,sep){sep=sep||"/";var y=dt.getFullYear(),M=KD.utils.Util.padZeros(dt.getMonth()+1,2),d=KD.utils.Util.padZeros(dt.getDate(),2),h=dt.getHours(),m=KD.utils.Util.padZeros(dt.getMinutes(),2),s=KD.utils.Util.padZeros(dt.getSeconds(),2),a="AM";if(h>=12){a="PM";if(h>12){h+=-12;}}h=KD.utils.Util.padZeros(h,2);return y+sep+M+sep+d+" "+h+":"+m+":"+s+" "+a;};this.getLocale=function(){if(navigator){if(navigator.userLanguage){return navigator.userLanguage;}else{if(navigator.browserLanguage){return navigator.browserLanguage;}else{if(navigator.systemLanguage){return navigator.systemLanguage;}else{if(navigator.language){return navigator.language;}}}}}return null;};this.removeBlankAttribute=function(el,attName){var att;if(el&&attName){att=el.getAttribute(attName);if(att==null||att.length==0){el.removeAttribute(attName);}}};this.removeBlankRequiredAttributes=function(){var a="required",c="answerValue",f=Dom.get("pageQuestionsForm");KD.utils.Util.getElementsByClassName(c,"input",f,function(o){KD.utils.Util.removeBlankAttribute(o,a);});KD.utils.Util.getElementsByClassName(c,"textarea",f,function(o){KD.utils.Util.removeBlankAttribute(o,a);});KD.utils.Util.getElementsByClassName(c,"select",f,function(o){KD.utils.Util.removeBlankAttribute(o,a);});};this._checkClassName=function(els,className){var result=false;if(!KD.utils.Util.isArray(els)){els=new Array(els);}var test=KD.utils.Util.hasClass(els,className);for(var i=0;i<test.length;i++){if(test[i]){result=true;break;}}return result;};this._isDateQuestion=function(els){return KD.utils.Util._checkClassName(els,"dateHidden");};this._isDateTimeQuestion=function(els){return KD.utils.Util._checkClassName(els,"dtHidden");};};}KD.utils.Hash=function(){this.length=0;this.items=new Array();for(var a=0;a<arguments.length;a+=2){if(typeof(arguments[a+1])!="undefined"){this.items[arguments[a]]=arguments[a+1];this.length++;}}this.removeItem=function(c){var b;if(typeof(this.items[c])!="undefined"){this.length--;b=this.items[c];delete this.items[c];}return b;};this.getItem=function(b){return this.items[b];};this.setItem=function(b,c){if(typeof(c)!="undefined"){if(typeof(this.items[b])=="undefined"){this.length++;}this.items[b]=c;}return c;};this.hasItem=function(b){return typeof(this.items[b])!="undefined";};};KD.utils.Client=function(){this.requiredFields=new KD.utils.Hash();this.patternFields=new KD.utils.Hash();this.eventFields=new KD.utils.Hash();};
if(typeof Dom=="undefined"){Dom=YAHOO.util.Dom;}if(typeof Connect=="undefined"){Connect=YAHOO.util.Connect;}if(typeof KD=="undefined"){KD={};}if(typeof KD.utils=="undefined"){KD.utils={};}if(!KD.utils.ClientManager){KD.utils.ClientManager=new function(){this._elements=new KD.utils.Hash();this._connections=new KD.utils.Hash();this._invalidSessionRequest=new Array();this._unauthorizedSessionRequests={};this.sessionId="";this.errorMessage="";this.successMessage="";this.authenticated=false;this.userName="";this.templateId="";this.customerSurveyId="";this.categoryId="";this.submitType="";this.isNewPage=true;this.maxCharsOnSubmit=(64*1024)-1;this.tooManyCharactersForSubmitStr="A limit of "+this.maxCharsOnSubmit+" characters for a submit is being applied. Please reduce the number of characters you are attempting to submit.";this.requiredWarningStr="Required fields missing:";this.validFormatWarningStr="Invalid formatted fields:";this.submitButtons=new Array();this.isLoading=false;this.isSubmitting=false;this.sessionCheck=null;this.webAppContextPath="/kinetic";this.customEvents=new KD.utils.Hash();this.onSetFieldsReturn=null;this.onAttachMenu=null;this.init=function(){KD.utils.ClientManager.isLoading=true;if(window.ks_initSessionVars){ks_initSessionVars();}KD.utils.ClientManager.onSetFieldsReturn=new YAHOO.util.CustomEvent("onSetFieldsReturn");KD.utils.ClientManager.onAttachMenu=new YAHOO.util.CustomEvent("onAttachMenu");KD.utils.ClientManager.initElements();KD.utils.ClientManager.initDateFields();KD.utils.ClientManager.checkMessages();KD.utils.ClientManager.initLogin();var a=Dom.get("pageQuestionsForm");YAHOO.util.Event.addListener(a,"submit",KD.utils.Action.validateForm,a,true);if(typeof window.event!="undefined"){document.onkeydown=KD.utils.ClientManager.preventBackSpace;}else{document.onkeypress=KD.utils.ClientManager.preventBackSpace;}if(typeof(customInitialization)=="function"){customInitialization();}if(window.ks_actionsInit){ks_actionsInit();}KD.utils.ClientManager.isLoading=false;};this.processNonIDElement=function(d){var b,c,a;if(!d){return;}for(b=0;b<d.childNodes.length;b++){c=d.childNodes[b];if(!c){return;}a=KD.utils.Util.getIDPart(c.id);if(!a){this.processNonIDElement(c);}else{this._elements.setItem(a,KD.utils.Util.getElementType(c.id));KD.utils.Util.registerInCache(c);KD.utils.ClientManager.initPatternWatch(c);KD.utils.ClientManager.setPreRequire(c);}}};this.registerItems=function(h,a){var k,g,f,j,e,c,b,d;KD.utils.ClientManager._elements.setItem(h,KD.utils.Util.getElementType(a.id));for(e=0;e<a.childNodes.length;e+=1){k=a.childNodes[e];if(!k){continue;}g=KD.utils.Util.getIDPart(k.id);if(!g){continue;}if(k.id&&k.id.indexOf("SECTION_")!=-1){this._elements.setItem(KD.utils.Util.getIDPart(k.id),KD.utils.Util.getElementType(k.id));KD.utils.Util.registerInCache(k);for(c=0;c<k.childNodes.length;c++){b=k.childNodes[c];if(!b){continue;}d=KD.utils.Util.getIDPart(b.id);if(!d){this.processNonIDElement(b);}else{this._elements.setItem(d,KD.utils.Util.getElementType(b.id));KD.utils.Util.registerInCache(b);KD.utils.ClientManager.initPatternWatch(b);KD.utils.ClientManager.setPreRequire(b);}}}else{if(k.className&&k.className.indexOf("templateButtonLayer")!=-1){this._elements.setItem(g,KD.utils.Util.getElementType(k.id));KD.utils.Util.registerInCache(k);this.submitButtons.push(g);f=Dom.get("pageQuestionsForm");j=Dom.getElementsByClassName("templateButton","input",k);YAHOO.util.Event.addListener(j,"click",KD.utils.Action._submitButtonClick,[f,g],true);}else{if(k.id){this._elements.setItem(g,KD.utils.Util.getElementType(k.id));KD.utils.Util.registerInCache(k);KD.utils.ClientManager.initPatternWatch(k);KD.utils.ClientManager.setPreRequire(k);}}}}};this.initElements=function(){var e,b,d=Dom.get("pageID");if(d){b=d.value;}if(b&&b.length>10){e=Dom.get("PAGE_"+b);this.registerItems(b,e);}else{var a=KD.utils.Util.getElementsByClassName("templateContent","div");if(a){for(var c=0;c<a.length;c++){e=a[c];if(e){b=e.id;this.registerItems(KD.utils.Util.getIDPart(b),e);}}}}};this.checkMessages=function(){var a=Dom.get("message");if(a){if(KD.utils.ClientManager.successMessage&&KD.utils.ClientManager.successMessage!=""){a.innerHTML=KD.utils.ClientManager.successMessage;a.style.visibility="visible";a.style.display="block";}if(KD.utils.ClientManager.errorMessage&&KD.utils.ClientManager.errorMessage!=""){a.innerHTML=KD.utils.ClientManager.errorMessage;a.style.visibility="visible";a.style.display="block";}}else{if(KD.utils.ClientManager.errorMessage&&KD.utils.ClientManager.errorMessage!=""){alert(KD.utils.ClientManager.errorMessage);}}};this.initDateFields=function(){var c=KD.utils.Util.getElementsByClassName("dateYear","input");for(var b=0;b<c.length;b++){var a=c[b].id.substring(5);if(a){KD.utils.Action.setDateFields(a);}}c=KD.utils.Util.getElementsByClassName("dtYear","input");for(b=0;b<c.length;b++){a=c[b].id.substring(5);if(a){KD.utils.Action.setDateTimeFields(a);}}};this.initLogin=function(){var h=Dom.get("loginForm");var c=Dom.get("authenticatedName");if(KD.utils.ClientManager.authenticated){if(h){h=h.parentNode;var g=h.parentNode;g.removeChild(h);}if(c){var d=c.innerHTML;d=d.replace(/--loginName--/i,KD.utils.ClientManager.userName);c.innerHTML=d;}}else{if(c){var f=c.parentNode;f.removeChild(c);}var e=Dom.get("originatingPage");if(e){e.value=this.originatingPage;}var b=Dom.get("authenticationType");if(b){b.value=this.authenticationType;}var a=Dom.get("loginSessionID");if(a){a.value=Dom.get("sessionID").value;}}};this.getElementType=function(a){return this._elements.getItem(a);};this.clearInvalidSessionRequest=function(){KD.utils.ClientManager._invalidSessionRequest=new Array();};this.getInvalidSessionRequest=function(){return KD.utils.ClientManager._invalidSessionRequest;};this.registerInvalidSessionRequest=function(a,b,c,e){var d=new Array();d[0]=a;d[1]=b;d[2]=c;d[3]=e;KD.utils.ClientManager._invalidSessionRequest=d;};this.registerUnauthorizedSessionRequest=function(a,d,b,c){KD.utils.ClientManager._unauthorizedSessionRequests[a]=[a,d,b,c];
};this.setNewConnection=function(a,b){if(a!=null&&b!=null&&b.length>0){KD.utils.ClientManager._connections.setItem(a,b);}};this.isActiveConnection=function(a){var c=KD.utils.ClientManager._connections.getItem(a);var b=false;if(c!=null&&c.length>0){b=Connect.isCallInProgress(c[0]);}return b;};this.getConnection=function(a){var b;if(a!=null){b=KD.utils.ClientManager._connections.getItem(a);}return b;};this.addAction=function(d){if(d.jsEvent=="*custom*"||d.jsEvent=="submit"||d.jsEvent=="beforeSubmit"){var e=d.elementId;if(d.jsEvent=="submit"||d.jsEvent=="beforeSubmit"){e=e+"-"+d.jsEvent;}KD.utils.ClientManager.addCustomEvent(e,d);return;}if(d.jsEvent=="setFieldsReturn"||d.jsEvent=="attachMenu"){var b=KD.utils.ClientManager.onSetFieldsReturn;if(d.jsEvent=="attachMenu"){b=KD.utils.ClientManager.onAttachMenu;}b.subscribe(function(f,g,h){KD.utils.Action._customEventHandler(f,g,h);},d);return;}YAHOO.util.Event.addListener(d.elObj,d.jsEvent,function(f){d.action.apply(KD.utils.Action,[f,this]);},d,true);var c=new Array();if(KD.utils.Util.isArray(d.elObj)){c=d.elObj;}else{c.push(d.elObj);}for(var a=0;a<c.length;a++){KD.utils.Action.applyValueActions(c[a],d);}};this.addCustomEvent=function(c,b){var a=KD.utils.ClientManager.customEvents.getItem(c);if(a&&a.length>0){a.push(b);}else{a=[b];}KD.utils.ClientManager.customEvents.setItem(c,a);};this.initPatternWatch=function(a){var c=KD.utils.Util.getQuestionInput(KD.utils.Util.getIDPart(a.id));if(c&&!c.length){var b=c.getAttribute("validationFormat");if(b&&b!=""){YAHOO.util.Event.addListener(c,"focus",KD.utils.Action._disableButtonEvents);YAHOO.util.Event.addListener(c,"blur",KD.utils.Action.checkPattern);}else{if(c.tagName&&c.tagName.toUpperCase()=="TEXTAREA"&&c.getAttribute("maxlength")){YAHOO.util.Event.addListener(c,"keyup",function(f,d){KD.utils.Action.watchFieldLength(d);},c);YAHOO.util.Event.addListener(c,"change",function(f,d){KD.utils.Action.watchFieldLength(d);},c);}}}if(c&&!KD.utils.Util.isArray(c)){if(c.getAttribute("fileTypesAllowed")!=null){YAHOO.util.Event.addListener(c,"change",function(f,d){KD.utils.Action._setFileLink(d);},c);KD.utils.Action._setFileLink(c);}}};this.alertPanel=function(c){if(c==null){c={header:"Alert",body:"",element:null};}var f="validationAlert";var a=Dom.get(f);var b="validationAlertOk";try{if(!a){a=document.createElement("div");a.id=f;document.body.appendChild(a);var g=new YAHOO.widget.Panel(f,{visible:false,close:false,draggable:true,fixedcenter:true,constraintoviewport:true,zindex:2,iframe:true,modal:true});g.hideEvent.subscribe(function(){if(c.element&&c.element.focus&&c.element.style&&c.element.style.visiblity!="hidden"&&c.element.style.display!="none"){try{c.element.focus();c.element.select();}catch(e){}}});var i=document.createElement("input");i.id=b;i.type="button";i.value="OK";i.onclick=function(){g.hide();g.destroy();};}g.setHeader(c.header||"Form Errors: ");g.setBody((c.body||"").replace(/\n/g,"<br/>"));g.setFooter(i);g.render(document.body);g.show();}catch(h){var d=Dom.get(f);if(d){document.removeChild(d);}}};this.renderSimpleLogin=function(c){KD.utils.ClientManager.buildSimpleLogin(c);var h=function(){KD.utils.ClientManager.isSubmitting=false;for(var j=0;j<KD.utils.ClientManager.submitButtons.length;j+=1){KD.utils.Action.enableButton(KD.utils.ClientManager.submitButtons[j]);}this.cancel();this.destroy();};var b=function(){Connect.initHeader("X-Requested-With","XMLHttpRequest");this.submit();this.show();};var f=new YAHOO.widget.Dialog("simpleLogin",{width:"300px",fixedcenter:true,visible:false,constraintoviewport:true,close:false,modal:true,postmethod:"async",buttons:[{text:"Login",handler:b,isDefault:true},{text:"Cancel",handler:h}]});var a=function(n){KD.utils.ClientManager.isSubmitting=false;for(var j=0;j<KD.utils.ClientManager.submitButtons.length;j+=1){KD.utils.Action.enableButton(KD.utils.ClientManager.submitButtons[j]);}var m=KD.utils.ClientManager.getInvalidSessionRequest();if(m.length>0){if(m[0]==="PREV_PAGE_REQUEST"){KD.utils.Action.disableSubmitButtons();KD.utils.Action.loadPreviousPage();}else{if(m[0]==="NEXT_PAGE_REQUEST"){KD.utils.Action.disableSubmitButtons();document.pageQuestionsForm.submit();}else{if(m[1]!==null&&m[2]!==null&&m[3]!==null){Connect.asyncRequest(m[1],m[2],m[3]);}else{}}}}for(var l in KD.utils.ClientManager._unauthorizedSessionRequests){var k=KD.utils.ClientManager._unauthorizedSessionRequests[l];Connect.asyncRequest(k[1],k[2],k[3]);}f.hide();f.destroy();};var e=function(m){var k=null;if(m&&m.status){k=m.status;}var j=null;if(m&&m.getResponseHeader&&m.getResponseHeader["X-Error-Message"]){j=m.getResponseHeader["X-Error-Message"];}else{j="Error: "+k;}var i=Dom.get("simpleLoginMsg");if(i){i.innerHTML=j;Dom.setStyle(i,"display","block");}else{alert(j);}var l=Dom.get("simpleLoginPass");if(l){l.value="";l.select();l.focus();}};f.callback={success:a,failure:e,timeout:30000};f.validate=function(){var i=this.getData();if(i.UserName==""){alert("Please enter your Login ID");return false;}else{return true;}};f.render();f.show();f.focusFirst();var d=Dom.get("simpleLoginUser");var g=Dom.get("simpleLoginPass");if(d&&d.getAttribute("readOnly")!="true"){d.select();d.focus();}else{g.select();g.focus();}};this._findPreRequireObject=function(f){if(typeof f=="string"){f=KD.utils.Util.getQuestionLayer(f);}if(f==null||f=="undefined"||!f.children){return null;}var b=null;var h=null;var e;var c,a;for(c=0;c<f.children.length;c++){if(f.children[c].id!=undefined&&f.children[c].id.indexOf("QANSWER_")!=-1){var d=f.children[c].children;for(a=0;a<d.length;a++){if(d[a].id!=undefined&&d[a].id.indexOf("year_")!=-1){h=d[a];}if(d[a].id!=undefined&&d[a].id.indexOf("SRVQSTN_")!=-1){b=d[a];break;}}if(b==null){d=f.children[c].children[0].children;for(a=0;a<d.length;a++){if(d[a].id!=undefined&&d[a].id.indexOf("SRVQSTN_")!=-1){b=d[a];break;}}}}}e=h?"date":KD.utils.Util.getAnswerType(b);var g={"qElement":f,"qInput":b,"type":e,"dateInput":h};return g;};this.setPreRequire=function(c){var g=KD.utils.ClientManager._findPreRequireObject(c);
if(g==null){return;}var d=g.type;var b=g.qInput;var h=g.dateInput;var e=g.qElement;var a;if(b&&b.getAttribute("required")=="true"){KD.utils.Util.removeClass(e,"preRequiredRemovedLayer");KD.utils.Util.addClass(e,"preRequiredLayer");KD.utils.Util.addClass(e,"preRequiredLayer_"+d);for(a=0;a<e.children.length;a++){if(e.children[a].id!=undefined&&e.children[a].id.indexOf("QLABEL_")!=-1){KD.utils.Util.removeClass(e.children[a],"preRequiredRemovedLabel");KD.utils.Util.addClass(e.children[a],"preRequiredLabel");KD.utils.Util.addClass(e.children[a],"preRequiredLabel_"+d);break;}}for(a=0;a<e.children.length;a++){if(e.children[a].id!=undefined&&e.children[a].id.indexOf("QANSWER_")!=-1){KD.utils.Util.removeClass(e.children[a],"preRequiredRemovedAnswer");KD.utils.Util.addClass(e.children[a],"preRequiredAnswer");KD.utils.Util.addClass(e.children[a],"preRequiredAnswer_"+d);break;}}var f=h?h:b;KD.utils.Util.removeClass(f,"preRequiredRemovedInput");KD.utils.Util.addClass(f,"preRequiredInput");KD.utils.Util.addClass(f,"preRequiredInput_"+d);}};this.clearPreRequire=function(c){var g=KD.utils.ClientManager._findPreRequireObject(c);if(g==null){return;}var d=g.type;var b=g.qInput;var h=g.dateInput;var e=g.qElement;var a;if(b){KD.utils.Util.removeClass(e,"preRequiredLayer");KD.utils.Util.removeClass(e,"preRequiredLayer_"+d);KD.utils.Util.addClass(e,"preRequiredRemovedLayer");for(a=0;a<e.children.length;a++){if(e.children[a].id!=undefined&&e.children[a].id.indexOf("QLABEL_")!=-1){KD.utils.Util.removeClass(e.children[a],"preRequiredLabel");KD.utils.Util.removeClass(e.children[a],"preRequiredLabel_"+d);KD.utils.Util.addClass(e.children[a],"preRequiredRemovedLabel");break;}}for(a=0;a<e.children.length;a++){if(e.children[a].id!=undefined&&e.children[a].id.indexOf("QANSWER_")!=-1){KD.utils.Util.removeClass(e.children[a],"preRequiredAnswer");KD.utils.Util.removeClass(e.children[a],"preRequiredAnswer_"+d);KD.utils.Util.addClass(e.children[a],"preRequiredRemovedAnswer");break;}}var f=h?h:b;KD.utils.Util.removeClass(f,"preRequiredInput");KD.utils.Util.removeClass(f,"preRequiredInput_"+d);KD.utils.Util.addClass(f,"preRequiredRemovedInput");}};this.buildSimpleLogin=function(e){var c=false;var p=false;if(e){if(e.showAuthStr&&e.showAuthStr!=""){c=e.showAuthStr;}if(e.showUserName&&e.showUserName!=""){p=e.showUserName;}}if(Dom.get("simpleLogin")===null){var t=document.createElement("div");t.id="simpleLogin";t.className=" yui-skin-sam simpleLoginLayer";var j=document.createElement("div");j.className="hd";j.innerHTML="Your session has expired. Please login.";t.appendChild(j);var g=document.createElement("div");g.className="bd";t.appendChild(g);var i=document.createElement("div");i.id="simpleLoginMsg";Dom.setStyle(i,"display","none");g.appendChild(i);var b=document.createElement("form");b.name="Login";b.action="KSAuthenticationServlet";g.appendChild(b);var l=document.createElement("div");l.className="UserLayer";var m=document.createElement("div");m.className="leftCol";var o=document.createElement("div");o.className="rightCol";var a=document.createElement("label");a.className="simpleLoginLabel";a.innerHTML="Login ID";var d=document.createElement("input");d.id="simpleLoginUser";d.name="UserName";d.type="text";d.className="simpleLoginInput";m.appendChild(a);o.appendChild(d);l.appendChild(m);l.appendChild(o);b.appendChild(l);if(!p&&KD.utils.ClientManager.userName!=null&&KD.utils.ClientManager.userName.length>0){d.value=KD.utils.ClientManager.userName;d.setAttribute("readOnly","readOnly");d.style.backgroundColor=KD.utils.Action.readOnlyColor;}var h=document.createElement("div");h.className="PasswordLayer";var s=document.createElement("div");s.className="leftCol";var q=document.createElement("div");q.className="rightCol";var r=document.createElement("label");r.className="simpleLoginLabel";r.innerHTML="Password";var u=document.createElement("input");u.id="simpleLoginPass";u.name="Password";u.type="password";u.className="simplePassInput";s.appendChild(r);q.appendChild(u);h.appendChild(s);h.appendChild(q);b.appendChild(h);if(c){var n=document.createElement("div");var f=document.createElement("label");f.className="simpleLoginLabel";f.innerHTML="Authentication";var k=document.createElement("input");k.id="simpleLoginAuth";k.name="Authentication";k.type="text";k.className="simpleLoginInput";n.appendChild(f);n.appendChild(k);b.appendChild(n);}document.body.insertBefore(t,document.body.childNodes[0]);}};this.checkSession=function(a){KD.utils.ClientManager.sessionCheck=null;var c=a===true?"&auth=forced":"";var d=new Date().getTimezoneOffset();var b="resources/includes/sessionCheck.jsp?tzOffset="+d+"&srv="+encodeURIComponent(KD.utils.ClientManager.templateId)+c;var e={success:function(f){KD.utils.ClientManager.sessionCheck=f;},failure:function(f){KD.utils.ClientManager.sessionCheck=f;},argument:[{timeout:5000}]};KD.utils.Action._makeSyncRequest(b,e);};this.preventBackSpace=function(g){var b,f,d,a,c,h=false;if(typeof window.event!="undefined"){b=window.event;}else{b=YAHOO.util.Event.getEvent(g);}if(!b){return;}if(YAHOO.util.Event.getCharCode(b)==8){f=YAHOO.util.Event.getTarget(b);if(f){d=f.getAttribute("readOnly");if(d&&(d=="readOnly"||d==true)){h=true;}a=f.tagName;c=f.type;if(!h&&((a&&((a.toUpperCase()=="TEXTAREA")||((a.toUpperCase()=="INPUT")&&(c&&(c.toUpperCase()=="TEXT"||c.toUpperCase()=="PASSWORD"))))))){return;}}YAHOO.util.Event.stopEvent(b);}};this.enforceSameOriginFrame=function(){try{top.document.domain;}catch(b){var a=function(){document.body.innerHTML="";document.head.innerHTML="";};setInterval(a,1);if(document.body){document.body.onload=a;}}};};}KD.utils.ClientAction=function(b){this.elementId=null;this.elObj=null;this.jsEvent=null;this.action=null;this.ifExpr=null;this.actionId=null;this.params=null;this.currEvt=null;this.synchronous=null;this.source=null;this.useGetEntry=null;this.timeout=null;if(b){this.elementId=b.elementId;this.jsEvent=b.jsEvent;this.action=b.action;this.ifExpr=b.ifExpr;this.actionId=b.actionId;this.params=b.params;
this.elObj=KD.utils.Util.getQuestionInput(this.elementId);this.source=b.source||"local";this.synchronous=b.synchronous;this.useGetEntry=b.useGetEntry;this.timeout=b.timeout;if(!this.elObj){var a=KD.utils.Util.getPrefixFromType(KD.utils.ClientManager.getElementType(this.elementId))+this.elementId;this.elObj=Dom.get(a);}}};if(typeof KD.bridges=="undefined"){KD.bridges={};}if(!KD.bridges.BridgeManager){KD.bridges.BridgeManager=function(){};KD.bridges.BridgeManager.bridgeRequest=function(d,c,a){if(typeof YAHOO==="undefined"||typeof YAHOO.util==="undefined"||typeof YAHOO.util.Connect==="undefined"){var b="The YUI Connection library is required for "+"bridging.  Please ensure the YUI connection_core.js, "+"connection_core-min.js, connection.js, or connection-min.js "+"file is being loaded by the page.";alert(b);throw (b);}YAHOO.util.Connect.asyncRequest(d,c,a);};KD.bridges.BridgeManager.defaultFailureCallback=function(a){var b="There was a problem executing the bridge request.\n";if(a.status!=200){b+="("+a.status+") "+a.statusText;}else{b+="\n"+a.responseMessage;}alert(b);throw (b);};KD.bridges.BridgeManager.parseJson=function(a){if(typeof YAHOO==="undefined"||typeof YAHOO.lang==="undefined"||typeof YAHOO.lang.JSON==="undefined"){var b="The YUI JSON library is required for bridging.  "+"Please ensure the YUI json.js or json-min.js file is being "+"loaded by the page.";alert(b);throw (b);}return YAHOO.lang.JSON.parse(a);};KD.bridges.BridgeManager.stringify=function(a){if(typeof YAHOO==="undefined"||typeof YAHOO.lang==="undefined"||typeof YAHOO.lang.JSON==="undefined"){var b="The YUI JSON library is required for bridging.  "+"Please ensure the YUI json.js or json-min.js file is being "+"loaded by the page.";alert(b);throw (b);}return YAHOO.lang.JSON.stringify(a);};KD.bridges.BridgeManager.keys=Object.keys||function(c){if(c!==Object(c)){throw new TypeError("Invalid object");}var b=[];for(var a in c){if(Object.prototype.hasOwnProperty.call(c,a)){b[b.length]=a;}}return b;};}if(!KD.bridges.BridgeConnector){KD.bridges.BridgeConnector=function(c){var b=this;c=c||{};if(c.templateId==undefined||c.webAppRoot==undefined){if(typeof KD=="undefined"||typeof KD.utils=="undefined"||typeof KD.utils.ClientManager=="undefined"){throw new Error("KD.utils.ClientManager does not exist, "+"unable to automatically obtain configuration values.");}else{if(c.templateId==undefined){c.templateId=KD.utils.ClientManager.templateId;}if(c.webAppRoot==undefined){c.webAppRoot=KD.utils.ClientManager.webAppContextPath;}}}this.templateId=c["templateId"];this.webAppRoot=c["webAppRoot"];if(this.webAppRoot.charAt(this.webAppRoot.length-1)!="/"){this.webAppRoot=this.webAppRoot+"/";}this.count=function(i,j,h){d(i,j,h);var k=f("count",i,j,h);var g=a(h,function(l){return new KD.bridges.Count(l.value,l.metadata);});KD.bridges.BridgeManager.bridgeRequest("GET",k,g);};this.retrieve=function(i,j,h){d(i,j,h);var k=f("retrieve",i,j,h);var g=a(h,function(l){return new KD.bridges.Record(l.attributes,l.metadata);});KD.bridges.BridgeManager.bridgeRequest("GET",k,g);};this.search=function(i,j,h){d(i,j,h);var k=f("search",i,j,h);var g=a(h,function(l){return new KD.bridges.RecordList(l.fields,l.records,l.metadata);});KD.bridges.BridgeManager.bridgeRequest("GET",k,g);};var e=function(i,j){var h="";for(var g in (j||{})){h+="&"+i+'["'+g+'"]='+j[g];}return h;};var a=function(g,h){return{success:function(j){if(g["debug"]&&typeof console!=="undefined"){console.log("RESPONSE: "+j.responseText);}var k=KD.bridges.BridgeManager.parseJson(j.responseText);if(k.responseCode==200){var i=h(k.data);g["success"](i);}else{j.responseCode=k.responseCode;j.responseMessage=k.responseMessage;g["failure"](j);}},failure:function(i){if(g["debug"]&&typeof console!=="undefined"){console.log("RESPONSE: "+i.responseText);}g["failure"](i);}};};var f=function(j,h,i,g){var k=b.webAppRoot+"BridgeDataRequest"+"?action="+j+"&formId="+b.templateId+"&model="+h+"&qualification="+i;if(g["attributes"]!=null){k+="&attributes="+g["attributes"].join(",");}k+=e("parameter",g["parameters"]);k+=e("metadata",g["metadata"]);k+="&noCache="+new Date().getTime();return k;};var d=function(h,i,g){g=g||{};g["failure"]=g["failure"]||KD.bridges.BridgeManager.defaultFailureCallback;if(!(typeof h=="string")){throw new TypeError("The 'model' parameter must be a valid string.");}else{if(!(typeof i=="string")){throw new TypeError("The 'qualification' parameter must be a valid string.");}}if(!(typeof g["success"]=="function")){throw new TypeError("The 'success' config value must be a valid function.");}};};}if(!KD.bridges.Count){KD.bridges.Count=function(b,a){if(b==0){this.value=0;}else{this.value=b||null;}this.metadata=a||{};this.toJson=function(){return KD.bridges.BridgeManager.stringify(this.toObject());};this.toObject=function(){var c={value:this.value};if(KD.bridges.BridgeManager.keys(this.metadata).length>0){c.metadata=this.metadata;}return c;};this.toString=function(){return"[object KD.bridges.Count]";};};}if(!KD.bridges.Record){KD.bridges.Record=function(a,b){this.attributes=a||null;this.metadata=b||{};this.exists=function(){return(this.attributes)?true:false;};this.toJson=function(){return KD.bridges.BridgeManager.stringify(this.toObject());};this.toObject=function(){var c={attributes:this.attributes};if(KD.bridges.BridgeManager.keys(this.metadata).length>0){c.metadata=this.metadata;}return c;};this.toString=function(){return"[object KD.bridges.Record]";};};}if(!KD.bridges.RecordList){KD.bridges.RecordList=function(a,c,f){this.fields=a;this.records=[];if(c){for(var e=0;e<c.length;e++){if(typeof c[e]=="KD.bridges.Record"){this.records.push(c[e]);}else{if(typeof c[e]=="object"){var b={};for(var d=0;d<a.length;d++){b[a[d]]=c[e][d];}this.records.push(new KD.bridges.Record(b));}}}}this.metadata=f||{};this.first=function(){return this.records[0]||null;};this.get=function(g){return this.records[g]||null;};this.last=function(){return this.records[this.records.length-1]||null;};this.toJson=function(){return KD.bridges.BridgeManager.stringify(this.toObject());
};this.toObject=function(){var l={fields:this.fields,records:[]};for(var k=0;k<this.records.length;k++){var g=this.records[k].toObject();var h=[];for(var j=0;j<this.fields.length;j++){h.push(g.attributes[this.fields[j]]);}l.records.push(h);}if(KD.bridges.BridgeManager.keys(this.metadata).length>0){l.metadata=this.metadata;}return l;};this.toString=function(){return"[object KD.bridges.RecordList]";};};}