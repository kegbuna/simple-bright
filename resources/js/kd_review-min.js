(function(){var K=KD.utils,Dom=YAHOO.util.Dom,Connect=YAHOO.util.Connect;K.Review={currentDisplayedPageID:"",currentPageID:"",currPageObj:null,pageDocument:null,largestHeight:0,init:function(evt){clientManager.init();if(this.reviewObj&&this.reviewObj.loadAllPages==true){if(this.reviewObj.pageIds){var pageIds=this.reviewObj.pageIds;for(var i=0;i<pageIds.length;i+=1){try{eval("("+pageIds[i]+"_ks_actionsInit()"+")");}catch(e){}}}K.Review.setToReadOnly(Dom.get("reviewContent"));K.Review.setFullHeight();}else{try{K.Review.currentPageID=K.Review.setCurrentPageID(K.Review.currentDisplayedPageID);eval("("+K.Review.currentPageID+"_ks_actionsInit()"+")");}catch(ex){}K.Review.setToReadOnly(K.Review.currentDisplayedPageID);K.Review.setHeight();}},setToReadOnly:function(root){var objs=K.Util.getElementsByClassName("questionAnswer","*",root),i,label;for(i=0;i<objs.length;i+=1){label=objs[i].getAttribute("label");K.Action.setReadOnly(label);}},setHeight:function(allSameSize){var iFrameObj=parent.document.getElementById("reviewRequest"),offset,navBar=document.getElementById("globalnav");if(navBar!=null){offset=navBar.clientHeight;}else{offset=0;}if(!K.Review.currPageObj){K.Review.currPageObj=Dom.get(K.Review.currentDisplayedPageID);}if(K.Review.currPageObj&&K.Review.currPageObj.clientHeight>K.Review.largestHeight){K.Review.largestHeight=K.Review.currPageObj.clientHeight;}if(iFrameObj){iFrameObj.style.height=allSameSize===true?K.Review.largestHeight+offset+"px":K.Review.currPageObj.clientHeight+offset+"px";}},setFullHeight:function(){var iFrameObj=parent.document.getElementById("reviewRequest"),offset=20,cHeight;if(iFrameObj){if(iFrameObj.document){var o=document.getElementById("reviewContent");cHeight=o.offsetHeight;}else{cHeight=iFrameObj.contentDocument.body.clientHeight;}iFrameObj.style.height=cHeight+offset+"px";}},showPage:function(el,pageID,instanceID){var myContext="/kinetic",objs=K.Util.getElementsByClassName("selectedTab","a",document),pageObj,path,callback,response,message,valid=true;if(objs.length>0){objs[0].className="";}el.className="selectedTab";if(K.ClientManager.webAppContextPath){myContext=K.ClientManager.webAppContextPath;}K.Review.currPageObj=Dom.get(K.Review.currentDisplayedPageID);K.Review.currPageObj.style.display="none";K.Review.currentPageID=K.Review.setCurrentPageID(pageID);pageObj=Dom.get(pageID);pageObj.style.display="block";K.Review.currentDisplayedPageID=pageID;K.Review.currPageObj=pageObj;var loaded=false;var pageChildren=Dom.getChildren(pageObj);for(var i in pageChildren){if(Dom.hasClass(pageChildren[i],"templateContent")){loaded=true;break;}}if(!loaded){path=myContext+"/ReviewRequestPage?csrv="+encodeURIComponent(clientManager.customerSurveyId)+"&pageInstanceID="+encodeURIComponent(instanceID);callback={success:K.Review.handlePageSuccess,failure:K.Review.handlePageFailure,argument:{clickedPageId:pageID}};if(KD.utils.ClientManager.isAuthenticationRequired==="true"){KD.utils.ClientManager.checkSession();response=KD.utils.ClientManager.sessionCheck;if(response.status!==200){message=response.statusText;if(response.getResponseHeader!=null&&response.getResponseHeader["X-Error-Message"]!=null){message=response.getResponseHeader["X-Error-Message"];}KD.utils.ClientManager.registerInvalidSessionRequest("REVIEW_REQUEST_"+pageID,"GET",path,callback);KD.utils.Action.handleHttpErrorCode(response.status,message);valid=false;}}if(valid){K.ClientManager.isLoading=false;Connect.asyncRequest("GET",path,callback);}}else{K.Review.setHeight();}},handlePageSuccess:function(o){var clickedPageId,clickedPageObj,pageId,pageDocument;clickedPageId=o.argument["clickedPageId"];if(clickedPageId){clickedPageObj=Dom.get(clickedPageId);}if(clickedPageObj&&o.responseText!==undefined){clickedPageObj.innerHTML=o.responseText;pageId=K.Review.setCurrentPageID(clickedPageId);clientManager.init();eval("("+pageId+"_ks_actionsInit()"+")");K.Review.setToReadOnly(clickedPageObj);K.Review.setHeight();}},handlePageFailure:function(o){var clickedPageId,clickedPageObj;clickedPageId=K.Review.currentDisplayedPageID;if(clickedPageId){clickedPageObj=Dom.get(clickedPageId);}if(clickedPageObj&&o.responseText!==undefined){clickedPageObj.innerHTML="<li>Transaction id: "+o.tId+"</li>";clickedPageObj.innerHTML+="<li>HTTP status: "+o.status+"</li>";clickedPageObj.innerHTML+="<li>Status code message: "+o.statusText+"</li>";K.Review.setHeight();}K.ClientManager.isLoading=false;},setCurrentPageID:function(pageId){var id="";if(pageId&&pageId.length>0){id=pageId.slice("pageHolder_".length);}return id;}};})();